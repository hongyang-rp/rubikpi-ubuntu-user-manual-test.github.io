<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Document Home/peripherals-and-interfaces-cn" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">外设与接口 | RUBIK Pi Ubuntu24.04 user Guide</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://rubikpi-ubuntu-user-manual-test.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://rubikpi-ubuntu-user-manual-test.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://rubikpi-ubuntu-user-manual-test.github.io/docs/Document Home/peripherals-and-interfaces-cn"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="外设与接口 | RUBIK Pi Ubuntu24.04 user Guide"><meta data-rh="true" name="description" content="硬件资源图"><meta data-rh="true" property="og:description" content="硬件资源图"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://rubikpi-ubuntu-user-manual-test.github.io/docs/Document Home/peripherals-and-interfaces-cn"><link data-rh="true" rel="alternate" href="https://rubikpi-ubuntu-user-manual-test.github.io/docs/Document Home/peripherals-and-interfaces-cn" hreflang="en"><link data-rh="true" rel="alternate" href="https://rubikpi-ubuntu-user-manual-test.github.io/docs/Document Home/peripherals-and-interfaces-cn" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Document Home","item":"https://rubikpi-ubuntu-user-manual-test.github.io/docs/category/document-home"},{"@type":"ListItem","position":2,"name":"外设与接口","item":"https://rubikpi-ubuntu-user-manual-test.github.io/docs/Document Home/peripherals-and-interfaces-cn"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="RUBIK Pi Ubuntu24.04 user Guide RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="RUBIK Pi Ubuntu24.04 user Guide Atom Feed"><link rel="stylesheet" href="/assets/css/styles.05faaaee.css">
<script src="/assets/js/runtime~main.fa4f55ec.js" defer="defer"></script>
<script src="/assets/js/main.615c415a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/document-home">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/document-home">Document Home</a><button aria-label="Collapse sidebar category &#x27;Document Home&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Document Home/revision-history-cn">文档更新说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Document Home/get-started-cn">快速开始</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Document Home/peripherals-and-interfaces-cn">外设与接口</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Document Home/github-peration-guide-cn">GitHhub 操作指南</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/document-home"><span>Document Home</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">外设与接口</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>外设与接口</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="硬件资源图">硬件资源图<a href="#硬件资源图" class="hash-link" aria-label="Direct link to 硬件资源图" title="Direct link to 硬件资源图">​</a></h2>
<p><img decoding="async" loading="lazy" src="/assets/images/image-101-b058ec7290f75edef757ac25b02831df.png" width="1473" height="621" class="img_ev3q"></p>
<table><thead><tr><th>序号</th><th>接口</th><th>序号</th><th>接口</th></tr></thead><tbody><tr><td>1</td><td>RTC 电池接口</td><td>10</td><td>Type-C 电源接口</td></tr><tr><td>2</td><td>Micro USB (UART 调试)</td><td>11</td><td>PWR 按键</td></tr><tr><td>3</td><td>TurboX C6490P SOM</td><td>12</td><td>EDL 按键</td></tr><tr><td>4</td><td>3.5mm 耳机接口</td><td>13</td><td>摄像头接口 2</td></tr><tr><td>5</td><td>USB Type-C with DP (USB 3.1)</td><td>14</td><td>摄像头接口 1</td></tr><tr><td>6</td><td>USB Type-A (USB 2.0)</td><td>15</td><td>Wi-Fi/蓝牙模块</td></tr><tr><td>7</td><td>2 x USB Type-A (USB 3.0)</td><td>16</td><td>风扇接口</td></tr><tr><td>8</td><td>1000M 以太网</td><td>17</td><td>40-pin 连接器</td></tr><tr><td>9</td><td>HDMI OUT</td><td>18</td><td>M.2 Key M 接口</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="40-pin-连接器">40 pin 连接器<a href="#40-pin-连接器" class="hash-link" aria-label="Direct link to 40 pin 连接器" title="Direct link to 40 pin 连接器">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gpio">GPIO<a href="#gpio" class="hash-link" aria-label="Direct link to GPIO" title="Direct link to GPIO">​</a></h3>
<p>RUBIK Pi 3 适配了 WiringRP（基于高性能 GPIO 编程库 WiringPi），推荐使用 WiringRP 来控制 GPIO，和对 GPIO 编程。关于 WiringRP 详细信息可访问 <a href="https://github.com/rubikpi-ai/WiringRP" target="_blank" rel="noopener noreferrer">https://github.com/rubikpi-ai/WiringRP</a> 查看。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布">引脚分布<a href="#引脚分布" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和树梅派 40-pin 连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-96-2d6ead37e894c54234b9f51c2a37682e.png" width="1465" height="929" class="img_ev3q"></p>
<p>下表是 40-pin连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-94-aa0e5ce4ae3141c73c6dbb79cb10d723.png" width="1501" height="634" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-shell-命令控制">使用 shell 命令控制<a href="#使用-shell-命令控制" class="hash-link" aria-label="Direct link to 使用 shell 命令控制" title="Direct link to 使用 shell 命令控制">​</a></h4>
<p>在 RUBIK Pi 3 中执行下面的步骤控制 GPIO。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>下面命令需要使用 root 权限：</p><blockquote>
<ul>
<li>
<p>执行 <code>sudo passwd root</code> 命令根据提示修改 root 帐号密码，使用 <code>su root</code> 命令切换到 root 用户。</p>
</li>
<li>
<p>或在普通用户下，在命令前加入 <code>sudo</code> ，如 <code>sudo gpio readall</code>，根据提示输入用户的登录密码。</p>
</li>
</ul>
</blockquote></div></div>
<ul>
<li>
<p>使用 WiringRP 相关命令</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ol>
<li>需将 <code>deb http://apt.rubikpi.ai ppa main</code> 追加到 <em>/etc/apt/sources.list</em> 文件中。</li>
<li>执行 <code>apt update</code> 命令更新软件源。</li>
<li>执行 <code>apt install wiringrp</code> 命令安装 WiringRP.</li>
</ol>
</blockquote></div></div>
<ul>
<li>
<p>查看 GPIO 状态</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gpio readall</span><br></span></code></pre></div></div>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/image-98-f04052d726a084ec76790bf283b1f7ae.png" width="825" height="606" class="img_ev3q"></p>
<ul>
<li>
<p>设置 GPIO 模式</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gpio mode 15 in             # 将15号引脚模式置为输入</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio pins                   # 查看更改之后的状态</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio mode 15 out            # 将15号引脚模式置为输出</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio pins                   # 查看更改之后的状态</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置引脚电平</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gpio write 15 1             # 将15号引脚置为高电平</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio read 15                # 读取更改后引脚状态</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio write 15 0             # 将15号引脚置为低电平</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpio read 15                # 读取更改后引脚状态</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>操作 <em>/sys/class/gpio</em> 下相关节点</p>
<p>GPIO 子系统的编号如下表。</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/20250603-170502-cccc3b3a23ff845b9fd368f46d6719cf.jpg" width="797" height="598" class="img_ev3q"></p>
<ul>
<li>进入 <em>/sys/class/gpio</em> 目录：</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/class/gpio</span><br></span></code></pre></div></div>
<ul>
<li>将要控制的 GPIO 导出，如控制 13 号引脚 GPIO_24：</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 571 &gt; export</span><br></span></code></pre></div></div>
<ul>
<li>进入到 gpio571 目录设置 GPIO 属性：</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd gpio571</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250603-174456-f320714cc2e14ed99d2f728a699e3b5f.jpg" width="649" height="124" class="img_ev3q"></p>
<ul>
<li>
<p>direction（方向）：</p>
<ul>
<li>输入：in</li>
<li>输出：out</li>
</ul>
</li>
<li>
<p>value（值）：</p>
<ul>
<li>低电平：0</li>
<li>高电平：1</li>
</ul>
</li>
<li>
<p>edge （中断边沿）：</p>
<ul>
<li>上升沿触发：rising</li>
<li>下降沿触发：falling</li>
<li>双边沿触发：both</li>
<li>禁用中断：none</li>
</ul>
<p>如设置 13 号引脚输出高电平：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo out &gt; direction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; value</span><br></span></code></pre></div></div>
<p>取消导出 13 号引脚到用户空间：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 571 &gt; unexport</span><br></span></code></pre></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-c-控制">使用 WiringRP (C) 控制<a href="#使用-wiringrp-c-控制" class="hash-link" aria-label="Direct link to 使用 WiringRP (C) 控制" title="Direct link to 使用 WiringRP (C) 控制">​</a></h4>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ol>
<li>需将 <code>deb http://apt.rubikpi.ai ppa main</code> 追加到 <em>/etc/apt/sources.list</em> 文件中。</li>
<li>执行 <code>apt update</code> 命令更新软件源。</li>
<li>执行 <code>apt install wiringrp</code> 命令安装 WiringRP.</li>
</ol>
</blockquote></div></div>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>以下代码示例，代码将 13 号引脚设置为输出， 15 号引脚设置为输入，循环检测 15 号引脚的电平状态：</li>
</ul>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPi.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">wiringPiSetup</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">pinMode</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OUTPUT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">pinMode</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> INPUT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">digitalWrite</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> HIGH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// On</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">digitalRead</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// On</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">delay</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// mS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">digitalWrite</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> LOW</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Off</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">digitalRead</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// On</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">delay</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1900</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<ul>
<li>
<p>编译程序</p>
<ul>
<li>在 RUBIK Pi 3 中编译</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scp 192.168.1.100@ubuntu ./gpio.c /opt  # IP 和用户名需根据情况修改</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc gpio.c -o gpio -lwiringPi</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>若无 gcc 命令，可执行 <code>apt install gcc</code> 命令进行安装。</p></div></div>
</li>
<li>
<p>将 13 和 15 号引脚使用杜邦线短接，测试 GPIO 电平控制和电平读取情况，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155538-8daa3d831befe66aae6b09d8d859396c.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./gpio</span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-113-eff5093e2f7a7c76a284319d2f7d960c.png" width="376" height="204" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-python-控制">使用 WiringRP-Python 控制<a href="#使用-wiringrp-python-控制" class="hash-link" aria-label="Direct link to 使用 WiringRP-Python 控制" title="Direct link to 使用 WiringRP-Python 控制">​</a></h4>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ol>
<li>需将 <code>deb http://apt.rubikpi.ai ppa main</code> 追加到 <em>/etc/apt/sources.list</em> 文件中。</li>
<li>执行 <code>apt update</code> 命令更新软件源。</li>
<li>执行 <code>apt install wiringrp-python</code> 命令安装 WiringRP-Python.</li>
</ol>
</blockquote></div></div>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>下方截取代码是使用 WiringRP 库操作 GPIO 的示例，其中将 13 号引脚设置为输出，15 号引脚设置为输入，循环检测 15 号引脚的电平状态。</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> wiringpi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">wiringPiSetup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pinMode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pinMode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digitalRead</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digitalWrite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pin_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digitalRead</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;in_gpio level: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pin_level</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digitalWrite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pin_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> wiringpi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digitalRead</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;in_gpio level: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pin_level</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>gpio.py </em>传输到 RUBIK Pi 3 中，如使用 SCP 传输。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scp 192.168.1.100@ubuntu ./gpio.py /opt  # IP 和用户名需根据情况修改</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 13 和 15 号引脚使用杜邦线短接，测试 GPIO 电平控制和电平读取情况，如下图所示</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155538-1-8daa3d831befe66aae6b09d8d859396c.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 gpio.py</span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-114-90783db10210c27e5cdf903a522039d0.png" width="429" height="186" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-python-程序控制">使用 Python 程序控制<a href="#使用-python-程序控制" class="hash-link" aria-label="Direct link to 使用 Python 程序控制" title="Direct link to 使用 Python 程序控制">​</a></h4>
<ul>
<li>
<p>可使用 Python 的 periphery 库控制 GPIO，可在 RUBIK Pi 3 中使用下面命令进行安装：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt install python3-periphery</span><br></span></code></pre></div></div>
</li>
<li>
<p>下方截取代码是使用 periphery 库操作 GPIO 的示例，其中将 13 号引脚设置为输出，15 号引脚设置为输入，循环检测 15 号引脚的电平状态。</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> periphery </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> GPIO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out_gpio </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GPIO</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">571</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;out&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">in_gpio </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GPIO</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">572</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;in&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pin_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;in_gpio level: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pin_level</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            pin_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;in_gpio level: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pin_level</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> KeyboardInterrupt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            out_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> IOError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    out_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    in_gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>gpio.py </em>传输到 RUBIK Pi 3 中，如使用 SCP 传输。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scp 192.168.1.100@ubuntu ./gpio.py /opt  # IP 和用户名需根据情况修改</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 13 和 15 号引脚使用杜邦线短接测试 GPIO 电平控制和电平读取情况，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155538-3-8daa3d831befe66aae6b09d8d859396c.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 gpio.py</span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-112-7daebd91a9090218685ea2aa55e16256.png" width="389" height="213" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-c-语言程序控制">使用 C 语言程序控制<a href="#使用-c-语言程序控制" class="hash-link" aria-label="Direct link to 使用 C 语言程序控制" title="Direct link to 使用 C 语言程序控制">​</a></h4>
<ul>
<li>
<p>以下代码示例，代码将 13 号引脚设置为输出， 15 号引脚设置为输入，循环检测 15 号引脚的电平状态：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> out_gpio </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">571</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> in_gpio </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">572</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> export_path</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> export_command</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/export&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;echo %d &gt; %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> out_gpio</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> export_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;echo %d &gt; %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> export_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">export_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> direction_path</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/gpio%d/direction&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> out_gpio</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FILE </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">direction_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;w&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open GPIO direction file&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;out&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fclose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/gpio%d/direction&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    direction_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;w&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open GPIO direction file&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;in&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fclose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direction_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> value_in_path</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> value_out_path</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> cat_command</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/gpio%d/value&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> out_gpio</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_in_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_in_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/gpio%d/value&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cat_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cat_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cat %s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value_in_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FILE </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">value_out_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;w&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open GPIO value file&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">fflush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cat_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">fflush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cat_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fclose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_out_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> unexport_path</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> unexport_command</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/sys/class/gpio/unexport&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;echo %d &gt; %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> out_gpio</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unexport_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">snprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;echo %d &gt; %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> in_gpio</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unexport_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">system</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexport_command</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>交叉编译。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aarch64-qcom-linux-gcc gpio.c -o gpio --sysroot=/home/zhy/qcom_sdk_meta/sysroots/armv8-2a-qcom-linux/</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中编译：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scp 192.168.1.100@ubuntu ./gpio.c /opt  # IP 和用户名需根据情况修改</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc gpio.c -o gpio</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>若无 gcc 命令，可执行 <code>apt install gcc</code> 命令进行安装。</p></div></div>
<p>若使用了交叉编译，需将 gpio 传输到 RUBIK Pi 3 中，如使用 ADB 传输：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push gpio /opt</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>将 13 和 15 号引脚使用杜邦线短接，测试 GPIO 电平控制和电平读取情况，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155538-2-8daa3d831befe66aae6b09d8d859396c.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./gpio</span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="269" height="215" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="i2c">I2C<a href="#i2c" class="hash-link" aria-label="Direct link to I2C" title="Direct link to I2C">​</a></h3>
<p>I2C 是飞利浦公司在 20 世纪 80 年代开发的一种双向 2 线制总线，用于实现高效的 IC 间控制总线。总线上的每个设备都有其唯一的地址（由飞利浦公司领导的 I2C 总机构注册）。I2C 核心支持多控制器模式，以及 10 位目标地址和 10 位可扩展地址。关于 I2C 的更多信息，请参阅 <a href="https://www.i2c-bus.org/fileadmin/ftp/i2c_bus_specification_1995.pdf" target="_blank" rel="noopener noreferrer">https://www.i2c-bus.org/fileadmin/ftp/i2c_bus_specification_1995.pdf</a></p>
<p>RUBIK Pi 3 适配了 WiringRP（基于高性能 GPIO 编程库 WiringPi ） ，推荐使用 WiringRP 来控制 I2C，和对 I2C 编程。关于 WiringRP 详细信息可访问 <a href="https://github.com/rubikpi-ai/WiringRP" target="_blank" rel="noopener noreferrer">https://github.com/rubikpi-ai/WiringRP</a> 查看。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布-1">引脚分布<a href="#引脚分布-1" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和树梅派 40-pin 连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-110-2d6ead37e894c54234b9f51c2a37682e.png" width="1465" height="929" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>3 号引脚和 5 号引脚默认已设置配为 I2C1。</p>
</blockquote></div></div>
<p>下表是 40-pin 连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-109-aa0e5ce4ae3141c73c6dbb79cb10d723.png" width="1501" height="634" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-shell-命令测试">使用 shell 命令测试<a href="#使用-shell-命令测试" class="hash-link" aria-label="Direct link to 使用 shell 命令测试" title="Direct link to 使用 shell 命令测试">​</a></h4>
<p>在 RUBIK Pi 3 中执行下面步骤控制 I2C 总线。</p>
<ul>
<li>
<p>使用 WiringRP 相关命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./gpio -x ads1115:100:10 aread 100     #通过 I2C 总线读取 ADS1115 设备的模拟信号值</span><br></span></code></pre></div></div>
</li>
<li>
<p>使用 i2cdetect 工具</p>
<ul>
<li>
<p>查看 I2C1 接口上的设备：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">i2cdetect -a -y -r 1</span><br></span></code></pre></div></div>
</li>
<li>
<p>读取地址为 0x38 设备的全部寄存器：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">i2cdump -f -y 1 0x38</span><br></span></code></pre></div></div>
</li>
<li>
<p>向地址为 0x38 设备的 0x01 寄存器地址写入 0xaa：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">i2cset -f -y 1 0x38 0x01 0xaa</span><br></span></code></pre></div></div>
</li>
<li>
<p>读取地址为 0x38 的设备，寄存器地址为0x01处的数值：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">i2cget -f -y 1 0x38 0x01</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>若无 <code>i2cdetect</code> 等命令，可执行 <code>apt install i2c-tools</code> 命令进行安装。</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-c-i2c-通信">使用 WiringRP (C) I2C 通信<a href="#使用-wiringrp-c-i2c-通信" class="hash-link" aria-label="Direct link to 使用 WiringRP (C) I2C 通信" title="Direct link to 使用 WiringRP (C) I2C 通信">​</a></h4>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ol>
<li>需将 <code>deb http://apt.rubikpi.ai ppa main</code> 追加到 <em>/etc/apt/sources.list</em> 文件中。</li>
<li>执行 <code>apt update</code> 命令更新软件源。</li>
<li>执行 <code>apt install wiringrp</code> 命令安装 WiringRP.</li>
</ol>
</blockquote></div></div>
<p>WiringRP 库中提供了一系列的 API函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例，I2C1总线和地址为0x38的设备进行通信，向设备0x01地址处写入0xaa：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPi.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPiI2C.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">I2C_ADDRESS</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression number" style="color:#36acaa">0x38</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> fd</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">wiringPiSetup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">wiringPiI2CSetup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> I2C_ADDRESS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">wiringPiI2CWriteReg8</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0xaa</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序</p>
<ul>
<li>
<p>在 RUBIK Pi 3 中编译</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push gpio.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc i2c.c -o i2c -lwiringPi</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>若无 gcc 命令，可执行 <code>apt install gcc</code> 命令进行安装。</p></div></div>
</li>
</ul>
</li>
<li>
<p>将 3 和 5 号引脚连接 I2C 传感器，验证 I2C 总线通信，如下图所示</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155532-2-3eb6a1470e7798c042f4735aa9812e29.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令运行程序：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./i2c</span><br></span></code></pre></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-python-i2c-通信">使用 WiringRP-Python I2C 通信<a href="#使用-wiringrp-python-i2c-通信" class="hash-link" aria-label="Direct link to 使用 WiringRP-Python I2C 通信" title="Direct link to 使用 WiringRP-Python I2C 通信">​</a></h4>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ol>
<li>需将 <code>deb http://apt.rubikpi.ai ppa main</code> 追加到 <em>/etc/apt/sources.list</em> 文件中。</li>
<li>执行 <code>apt update</code> 命令更新软件源。</li>
<li>执行 <code>apt install wiringrp-python</code> 命令安装 WiringRP-Python.</li>
</ol>
</blockquote></div></div>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例，使用 I2C1 总线和地址为 0x38 的设备进行通信，向设备 0x01 地址处写入 0xaa：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import wiringpi as wpi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpi.wiringPiSetup()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fd=wpi.wiringPiI2CSetup(0x38, 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpi.wiringPiI2CWriteReg8 (fd, 0x01, 0xaa)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>将<em> i2c.py </em>传输到 RUBIK Pi 3 中，如使用 ADB 传输。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push i2c.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 3 和 5 号引脚连接 I2C 传感器，验证 I2C 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155532-3eb6a1470e7798c042f4735aa9812e29.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 i2c.py </span><br></span></code></pre></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-python-程序-i2c-通信">使用 Python 程序 I2C 通信<a href="#使用-python-程序-i2c-通信" class="hash-link" aria-label="Direct link to 使用 Python 程序 I2C 通信" title="Direct link to 使用 Python 程序 I2C 通信">​</a></h4>
<ul>
<li>
<p>可使用 Python 的 smbus 库控制 I2C，可在 RUBIK Pi 3 中使用下面命令进行安装：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt install python3-smbus</span><br></span></code></pre></div></div>
</li>
<li>
<p>以下代码示例，使用 I2C1 总线和地址为 0x38 的设备进行通信，向设备 0x01 地址处写入 0xaa：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> smbus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0x01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0xaa</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        i2c_bus </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> smbus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SMBus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;i2cdetect addr : &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> address </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x7F</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                i2c_bus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write_i2c_block_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;0x{:02X},&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> OSError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;An error occurred: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> i2c_bus</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            i2c_bus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>i2c.py </em>传输到 RUBIK Pi 3中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push i2c.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 3 和 5 号引脚连接 I2C 传感器，验证 I2C 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155532-1-3eb6a1470e7798c042f4735aa9812e29.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 i2c.py</span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-108-3eb20207c371091ea8aab636f79ab2a7.png" width="372" height="75" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-c-语言程序-i2c-通信">使用 C 语言程序 I2C 通信<a href="#使用-c-语言程序-i2c-通信" class="hash-link" aria-label="Direct link to 使用 C 语言程序 I2C 通信" title="Direct link to 使用 C 语言程序 I2C 通信">​</a></h4>
<ul>
<li>
<p>以下代码示例，I2C1 总线和地址为 0x38 的设备进行通信，向设备 0x01 地址处写入 0xaa：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdint.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;fcntl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;linux/i2c-dev.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;sys/ioctl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">I2C_DEVICE_PATH</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;/dev/i2c-1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0x01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0xaa</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">i2c_device </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> I2C_DEVICE_PATH</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i2c_file</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_device</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> O_RDWR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open I2C device&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> I2C_TENBIT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> I2C_RETRIES</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;i2cdetect addr : &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x7f</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> x</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> I2C_SLAVE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to set I2C slave address&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;0x%x,&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i2c_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\r\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>交叉编译。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aarch64-qcom-linux-gcc i2c.c -o i2c --sysroot=/home/zhy/qcom_sdk_meta/sysroots/armv8-2a-qcom-linux/</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中编译</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push i2c.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc i2c.c -o i2c</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>若无 gcc 命令，可执行 <code>apt install gcc</code> 命令进行安装。</p></div></div>
<p>若使用的交叉编译，需要将 <em>i2c </em>传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push i2c /opt</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>将 3 和 5 号引脚连接 I2C 传感器，验证 I2C 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155532-3-3eb6a1470e7798c042f4735aa9812e29.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./i2c</span><br></span></code></pre></div></div>
<p>程序运行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-179-fa8f6212e8fdfdc5da78503fcf610cd2.png" width="362" height="58" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spi">SPI<a href="#spi" class="hash-link" aria-label="Direct link to SPI" title="Direct link to SPI">​</a></h3>
<p>串行外设接口 (SPI) 是在全双工模式下工作的同步串行数据链路。SPI 又称为 4 线制串行总线。</p>
<p>RUBIK Pi 3 适配了 WiringRP（基于高性能 GPIO 编程库 WiringPi），推荐使用 WiringRP 来控制 SPI，和对 SPI 编程。关于 WiringRP 详细信息可访问 <a href="https://github.com/rubikpi-ai/WiringRP" target="_blank" rel="noopener noreferrer">https://github.com/rubikpi-ai/WiringRP</a> 查看。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布-2">引脚分布<a href="#引脚分布-2" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和树梅派 40-pin 连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-122-2d6ead37e894c54234b9f51c2a37682e.png" width="1465" height="929" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>19 号、21 号、23 号、24 号引脚默认已设置配为 SPI。</p>
</blockquote></div></div>
<p>下表是 40-pin 连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-121-aa0e5ce4ae3141c73c6dbb79cb10d723.png" width="1501" height="634" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-c-spi-通信">使用 WiringRP (C) SPI 通信<a href="#使用-wiringrp-c-spi-通信" class="hash-link" aria-label="Direct link to 使用 WiringRP (C) SPI 通信" title="Direct link to 使用 WiringRP (C) SPI 通信">​</a></h4>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ol>
<li>需将 <code>deb http://apt.rubikpi.ai ppa main</code> 追加到 <em>/etc/apt/sources.list</em> 文件中。</li>
<li>执行 <code>apt update</code> 命令更新软件源。</li>
<li>执行 <code>apt install wiringrp</code> 命令安装 WiringRP.</li>
</ol>
</blockquote></div></div>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例，代码使用 SPI 总线进行数据收发通信：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPi.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPiSPI.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> fd</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> send_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">64</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;hello world!&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> read_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">64</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">wiringPiSetup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">wiringPiSPISetup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rtx_buffer: \n %s\n &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> send_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Send and receive data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">wiringPiSPIDataRW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> send_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">send_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rtx_buffer: \n %s\n &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> send_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序</p>
<ul>
<li>
<p>在 RUBIK Pi 3 中编译</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc spi.c -o spi -lwiringPi</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>若无 gcc 命令，可执行 <code>apt install gcc</code> 命令进行安装。</p></div></div>
</li>
</ul>
</li>
<li>
<p>将 19 号引脚和 21 号引脚使用杜邦线短接，验证 SPI 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155529-1-56979b8b599f3ebe8b766fefc246eeba.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./spi</span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-123-cf8f180a6874c39b0a52555606af0666.png" width="291" height="117" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-python-spi通信">使用 WiringRP-Python SPI通信<a href="#使用-wiringrp-python-spi通信" class="hash-link" aria-label="Direct link to 使用 WiringRP-Python SPI通信" title="Direct link to 使用 WiringRP-Python SPI通信">​</a></h4>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ol>
<li>需将 <code>deb http://apt.rubikpi.ai ppa main</code> 追加到 <em>/etc/apt/sources.list</em> 文件中。</li>
<li>执行 <code>apt update</code> 命令更新软件源。</li>
<li>执行 <code>apt install wiringrp-python</code> 命令安装 WiringRP-Python.</li>
</ol>
</blockquote></div></div>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例，代码使用 SPI 总线进行数据收发通信：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import wiringpi as wpi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpi.wiringPiSetup()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpi.wiringPiSPISetup(0, 8000000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tx_buffer = bytes([72, 101, 108, 108, 111])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;tx_buffer:\n\r &quot;, tx_buffer)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">retlen, rx_buffer = wpi.wiringPiSPIDataRW(0, tx_buffer)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;rx_buffer:\n\r &quot;, rx_buffer)</span><br></span></code></pre></div></div>
</li>
<li>
<p>将<em> spi.py </em>传输到 RUBIK Pi 3 中，如使用 ADB 传输。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 19 号引脚和 21 号引脚使用杜邦线短接，验证 SPI 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155529-2-56979b8b599f3ebe8b766fefc246eeba.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> python3 spi.py</span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-119-3fef89712fcf4d2666bf0bc733813456.png" width="410" height="118" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-python-程序-spi-通信">使用 Python 程序 SPI 通信<a href="#使用-python-程序-spi-通信" class="hash-link" aria-label="Direct link to 使用 Python 程序 SPI 通信" title="Direct link to 使用 Python 程序 SPI 通信">​</a></h4>
<ul>
<li>
<p>可使用 Python 的 spidev 库进行 SPI 通信，spidev 库可在 RUBIK Pi 3 中使用下面命令进行安装：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt install python3-spidev</span><br></span></code></pre></div></div>
</li>
<li>
<p>以下代码示例，代码使用 SPI 总线进行数据收发通信：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> spidev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tx_buffer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">ord</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">char</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> char </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello world!&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rx_buffer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        spi </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> spidev</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SpiDev</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">max_speed_hz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rx_buffer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xfer2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;tx_buffer:\n\r&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;rx_buffer:\n\r&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;An error occurred: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> spi</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>spi.py </em>传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 19 号引脚和 21 号引脚使用杜邦线短接，验证 SPI 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155529-3-56979b8b599f3ebe8b766fefc246eeba.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> python3 spi.py</span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-118-3fef89712fcf4d2666bf0bc733813456.png" width="410" height="118" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-c-语言程序-spi-通信">使用 C 语言程序 SPI 通信<a href="#使用-c-语言程序-spi-通信" class="hash-link" aria-label="Direct link to 使用 C 语言程序 SPI 通信" title="Direct link to 使用 C 语言程序 SPI 通信">​</a></h4>
<ul>
<li>
<p>以下代码示例，代码使用 SPI 总线进行数据收发通信：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdint.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;fcntl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;linux/spi/spidev.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;sys/ioctl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name" style="color:#36acaa">SPI_DEVICE_PATH</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;/dev/spidev12.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> spi_file</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello world!&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Open the SPI device</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SPI_DEVICE_PATH</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> O_RDWR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open SPI device&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Configure SPI mode and bits per word</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> mode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SPI_MODE_0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> bits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SPI_IOC_WR_MODE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">mode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to set SPI mode&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SPI_IOC_WR_BITS_PER_WORD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">bits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to set SPI bits per word&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Perform SPI transfer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">spi_ioc_transfer</span><span class="token plain"> transfer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tx_buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rx_buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">rx_buffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">len </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">delay_usecs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">speed_hz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// SPI speed in Hz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bits_per_word </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">ioctl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SPI_IOC_MESSAGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">transfer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to perform SPI transfer&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">/* Print tx_buffer and rx_buffer*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rtx_buffer: \n %s\n &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rrx_buffer: \n %s\n &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Close the SPI device</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spi_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>交叉编译。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aarch64-qcom-linux-gcc spi.c -o spi --sysroot=/home/zhy/qcom_sdk_meta/sysroots/armv8-2a-qcom-linux/</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中编译</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc spi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">o spi</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>若无 gcc 命令，可执行 <code>apt install gcc</code> 命令进行安装。</p></div></div>
</li>
<li>
<p>若使用的交叉编译，需要将 spi 传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push spi /opt</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>将 19 号引脚和 21 号引脚使用杜邦线短接，验证 SPI 总线通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155529-56979b8b599f3ebe8b766fefc246eeba.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./spi</span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-120-853b145d41fa26463746f0bbd5cf12a6.png" width="291" height="117" class="img_ev3q"></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="uart">UART<a href="#uart" class="hash-link" aria-label="Direct link to UART" title="Direct link to UART">​</a></h3>
<a id="UART"></a>
<p>RUBIK Pi 3 适配了 WiringRP（基于高性能 GPIO 编程库 WiringPi），推荐使用 WiringRP 来控制 UART，和对 UART 编程。关于 WiringRP 详细信息可访问 <a href="https://github.com/rubikpi-ai/WiringRP" target="_blank" rel="noopener noreferrer">https://github.com/rubikpi-ai/WiringRP</a> 查看。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="引脚分布-3">引脚分布<a href="#引脚分布-3" class="hash-link" aria-label="Direct link to 引脚分布" title="Direct link to 引脚分布">​</a></h4>
<p>下图是 RUBIK Pi 3 40-pin 连接器的引脚默认功能，其中大部分引脚和树梅派 40-pin 连接器引脚的默认功能兼容。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-116-2d6ead37e894c54234b9f51c2a37682e.png" width="1465" height="929" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>8 号和 10 号引脚默认已设置配为 UART，设备节点为 <em>/dev/ttyHS2</em>。</p>
</blockquote></div></div>
<p>下表是 40-pin 连接器支持的所有功能，图中蓝色字体表明默认功能。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-117-aa0e5ce4ae3141c73c6dbb79cb10d723.png" width="1501" height="634" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-shell-命令测试-1">使用 shell 命令测试<a href="#使用-shell-命令测试-1" class="hash-link" aria-label="Direct link to 使用 shell 命令测试" title="Direct link to 使用 shell 命令测试">​</a></h4>
<p>在 RUBIK Pi 3 中 使用下面命令控制串口通信</p>
<ul>
<li>
<p>使用 stty 工具配置串口，如下将串口的输入速率和输出速率都设置为 115200，并关闭回显：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stty -F /dev/ttyHS2 ispeed 115200 ospeed 115200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stty -F /dev/ttyHS2 -echo</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 上开启两个终端，将 8 号引脚和 10 号引脚使用杜邦线短接，分别执行下面命令，接收端会回显发送端的内容：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;hello world!&quot; &gt; /dev/ttyHS2  # 发送端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /dev/ttyHS2 # 接收端</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155526-c345d3dfa872572facaa31514bbc2917.jpg" width="4096" height="3072" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-c-uart通信">使用 WiringRP (C) UART通信<a href="#使用-wiringrp-c-uart通信" class="hash-link" aria-label="Direct link to 使用 WiringRP (C) UART通信" title="Direct link to 使用 WiringRP (C) UART通信">​</a></h4>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ol>
<li>需将 <code>deb http://apt.rubikpi.ai ppa main</code> 追加到 <em>/etc/apt/sources.list</em> 文件中。</li>
<li>执行 <code>apt update</code> 命令更新软件源。</li>
<li>执行 <code>apt install wiringrp</code> 命令安装 WiringRP.</li>
</ol>
</blockquote></div></div>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例，使用UART进行数据收发通信：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;errno.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringPi.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;wiringSerial.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> fd </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> count </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> nextTime </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">serialOpen</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/dev/ttyHS2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">115200</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">stderr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Unable to open serial device: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strerror</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">errno</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">wiringPiSetup</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fprintf</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">stdout</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Unable to start wiringPi: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strerror</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">errno</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello world!\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> count </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> count</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">serialPutchar</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">count</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">delay</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">serialGetchar</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>在 RUBIK Pi 3 中编译</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push uart.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc uart.c -o uart -lwiringPi</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>若无 gcc 命令，可执行 <code>apt install gcc</code> 命令进行安装。</p></div></div>
</li>
</ul>
</li>
<li>
<p>将 8 号引脚和 10 号引脚使用杜邦线短接，验证串口通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155526-1-c345d3dfa872572facaa31514bbc2917.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./uart</span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="287" height="58" class="img_ev3q"></p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-wiringrp-python-uart-通信">使用 WiringRP-Python UART 通信<a href="#使用-wiringrp-python-uart-通信" class="hash-link" aria-label="Direct link to 使用 WiringRP-Python UART 通信" title="Direct link to 使用 WiringRP-Python UART 通信">​</a></h4>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ol>
<li>需将 <code>deb http://apt.rubikpi.ai ppa main</code> 追加到 <em>/etc/apt/sources.list</em> 文件中。</li>
<li>执行 <code>apt update</code> 命令更新软件源。</li>
<li>执行 <code>apt install wiringrp-python</code> 命令安装 WiringRP-Python.</li>
</ol>
</blockquote></div></div>
<p>WiringRP 库中提供了一系列的 API 函数，用更少的逻辑实现控制。</p>
<ul>
<li>
<p>以下代码示例，使用 UART 进行数据收发通信：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import wiringpi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serial = wiringpi.serialOpen(&#x27;/dev/ttyHS2&#x27;, 115200)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi.serialPuts(serial, &quot;hello world&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">received_data = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = wiringpi.serialGetchar(serial);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">received_data.append(chr(c))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cnt = wiringpi.serialDataAvail(serial);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in range(cnt):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c = wiringpi.serialGetchar(serial);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    received_data.append(chr(c))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Received:&quot;, received_data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiringpi.serialClose(serial)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>uart.py </em>传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push uart.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 8 号引脚和 10 号引脚使用杜邦线短接，验证串口通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155526-4-c345d3dfa872572facaa31514bbc2917.jpg" width="4096" height="3072" class="img_ev3q"></p>
</li>
</ul>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 uart.py</span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-127-64fc05d7df4b7816f0a34922f9b28665.png" width="681" height="69" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-python-程序-uart-通信">使用 Python 程序 UART 通信<a href="#使用-python-程序-uart-通信" class="hash-link" aria-label="Direct link to 使用 Python 程序 UART 通信" title="Direct link to 使用 Python 程序 UART 通信">​</a></h4>
<ul>
<li>
<p>可使用 Python 的 serial 库进行 UART 通信，可在 RUBIK Pi 3 中使用下面命令进行安装：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt install python3-serial</span><br></span></code></pre></div></div>
</li>
<li>
<p>以下代码示例，使用 UART 进行数据收发通信：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> serial</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Serial</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;/dev/ttyHS2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    baudrate</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">115200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bytesize</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EIGHTBITS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stopbits</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">STOPBITS_ONE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    parity</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">serial</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PARITY_NONE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> uart3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uart3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b&quot;Hello World!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> uart3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Raw data:\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data_strings </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;utf-8&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Read {:d} bytes, printed as string:\n {:s}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_strings</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 <em>uart.py </em>传输到  RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push uart.py /opt</span><br></span></code></pre></div></div>
</li>
<li>
<p>将 8 号引脚和 10 号引脚使用杜邦线短接，验证串口通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155526-3-c345d3dfa872572facaa31514bbc2917.jpg" width="4096" height="3072" class="img_ev3q"></p>
</li>
</ul>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 uart.py</span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-183-c1cd8b284903fd70439052362cfcfeb8.png" width="414" height="166" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用-c-语言程序-uart-通信">使用 C 语言程序 UART 通信<a href="#使用-c-语言程序-uart-通信" class="hash-link" aria-label="Direct link to 使用 C 语言程序 UART 通信" title="Direct link to 使用 C 语言程序 UART 通信">​</a></h4>
<ul>
<li>
<p>以下代码示例，使用 UART 进行数据收发通信：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;fcntl.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;termios.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> serial_port_num </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> serial_port</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">sprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_port</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;/dev/ttyHS%d&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">serial_port_num</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> serial_fd</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    serial_fd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_port</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> O_RDWR </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> O_NOCTTY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to open serial port&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">termios</span><span class="token plain"> tty</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">memset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tcgetattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error from tcgetattr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">cfsetospeed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B9600</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">cfsetispeed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B9600</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tty</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">PARENB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tty</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">CSTOPB</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tty</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">&amp;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">~</span><span class="token plain">CSIZE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tty</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_cflag </span><span class="token operator" style="color:#393A34">|=</span><span class="token plain"> CS8</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tcsetattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TCSANOW</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">tty</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error from tcsetattr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello world!\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">ssize_t</span><span class="token plain"> bytes_written </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bytes_written </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">perror</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Error writing to serial port&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rtx_buffer: \n %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> bytes_read </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bytes_read </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rx_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">bytes_read</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token char">&#x27;\0&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\rrx_buffer: \n %s &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rx_buffer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;No data received.\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serial_fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
<li>
<p>编译程序：</p>
<ul>
<li>
<p>交叉编译。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aarch64-qcom-linux-gcc uart.c -o uart --sysroot=/home/zhy/qcom_sdk_meta/sysroots/armv8-2a-qcom-linux/</span><br></span></code></pre></div></div>
</li>
<li>
<p>在 RUBIK Pi 3 中编译</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push uart.c /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adb shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc uart.c -o uart</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>若无 gcc 命令，可执行 <code>apt install gcc</code> 命令进行安装。</p></div></div>
<p>若使用交叉编译，需要将 <em>uart </em>传输到 RUBIK Pi 3 中，如果使用 ADB 传输，命令如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">adb push uart /opt</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>将 8 号引脚和 10 号引脚使用杜邦线短接，验证串口通信，如下图所示：</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>注意引脚顺序，请勿将电源和地引脚短接，否则可能会造成板子损坏。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155526-2-c345d3dfa872572facaa31514bbc2917.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>运行如下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./uart</span><br></span></code></pre></div></div>
<p>程序执行结果如下：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-184-2d0067de790b14a089a0370c004120f0.png" width="291" height="102" class="img_ev3q"></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usb">USB<a href="#usb" class="hash-link" aria-label="Direct link to USB" title="Direct link to USB">​</a></h2>
<p>RUBIK Pi 3 拥有 4 个 USB 口：</p>
<ul>
<li>
<p>两个 USB 3.0 口，只能作为主机模式使用，如下图 7。</p>
</li>
<li>
<p>一个 USB 2.0 口，可以作为主机或设备模式使用，如下图 6。</p>
</li>
<li>
<p>一个 USB 3.1 Gen 1 口，可以作为主机或设备模式（ADB），以及 DP 显示使用，如下图 5。</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/image-125-f8c3c5533751ddd8dfbfc4bd201144f5.png" width="924" height="730" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usb-20-type-a-接口">USB 2.0 Type-A 接口<a href="#usb-20-type-a-接口" class="hash-link" aria-label="Direct link to USB 2.0 Type-A 接口" title="Direct link to USB 2.0 Type-A 接口">​</a></h3>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>执行 <code>sudo passwd root</code> 命令根据提示修改 root 帐号密码，使用 <code>su root</code> 命令切换到 root 用户。</p>
</blockquote></div></div>
<p>USB 2.0 接口默认为 host 模式，host 模式下将 U 盘插入，点击左侧文件浏览器图标，打开文件浏览器。</p>
<p>在文件浏览器中，点击左侧的 U 盘设备，即可显示 U 盘中的文件内容，并可对 U 盘中的文件进行拷贝写入等操作。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/20250603-184515-344e361817a3986f554d6375ed8a5e9f.jpg" width="1518" height="851" class="img_ev3q"></p>
<p>作为设备模式时需要手动执行命令切换，如下为一种切换方式，在 RUBIK Pi 3 终端中输入下面命令，将 RUBIK Pi 3 模拟为 U 盘：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/kernel/config/usb_gadget/  #在串口终端登录或在 Terminal 应用中，执行下面命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir g1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd g1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir functions/mass_storage.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dd if=/dev/zero of=/tmp/test.iso bs=1M count=2048  #创建大小为2G的U盘空间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkfs.ext4 /tmp/test.iso</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;/tmp/test.iso&quot; &gt; functions/mass_storage.0/lun.0/file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir configs/c.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ln -s functions/mass_storage.0/ configs/c.1/f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount -t debugfs none /sys/kernel/debug/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo device &gt; /sys/kernel/debug/usb/8c00000.usb/qcom_usb2_0_mode  #将USB切换为device模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 8c00000.usb &gt; UDC #连接USB线，U盘被识别 可在U盘内写入和写出文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo host &gt; /sys/kernel/debug/usb/8c00000.usb/qcom_usb2_0_mode  #拔掉USB线，切换为主机模式</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usb-31-type-c-接口">USB 3.1 Type-C 接口<a href="#usb-31-type-c-接口" class="hash-link" aria-label="Direct link to USB 3.1 Type-C 接口" title="Direct link to USB 3.1 Type-C 接口">​</a></h3>
<p>Type-C 接口默认为主机模式。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usb-调试">USB 调试<a href="#usb-调试" class="hash-link" aria-label="Direct link to USB 调试" title="Direct link to USB 调试">​</a></h3>
<p>本节提供有关获取调试日志的各种方法的信息。调试方式有 <code>regdumps</code> 、调试 <code>ftraces</code> 、 <code>configfs</code> 节点等。在调试与进入/退出低功耗模式、SMMU 故障、无时钟访问相关的问题时，可通过上述日志查看事件和控制器状态的详细信息。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>下面命令需切换到 root 用户：</p><blockquote>
<p>执行 <code>sudo passwd root</code> 命令根据提示修改 root 帐号密码，使用 <code>su root</code> 命令切换到 root 用户。</p>
</blockquote></div></div>
<ul>
<li>
<p>USB 2.0 Type-A 设备路径：<em> /sys/devices/platform/soc@0/<strong>8c00000</strong>.usb/xhci-hcd.1.auto/usb3/</em></p>
</li>
<li>
<p>USB 3.0 Type-A 设备路径：</p>
<ul>
<li>
<p><em>/sys/devices/platform/soc@0/<strong>1c00000</strong>.pci/pci0000:00/0000:00:00.0/0000:<strong>01:00.0</strong>/usb1</em></p>
</li>
<li>
<p><em>/sys/devices/platform/soc@0/<strong>1c00000</strong>.pci/pci0000:00/0000:00:00.0/0000:<strong>01:00.0</strong>/usb2</em></p>
</li>
</ul>
</li>
<li>
<p>USB 3.1 Type-C 设备路径：<em>/sys/devices/platform/soc@0/<strong>a600000</strong>.usb</em> </p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="usb-跟踪">USB 跟踪<a href="#usb-跟踪" class="hash-link" aria-label="Direct link to USB 跟踪" title="Direct link to USB 跟踪">​</a></h4>
<p>使用 <code>debugfs</code> 跟踪可以更加深入地了解 USB 线上发生的每一个事务。如需查看跟踪列表，可运行以下命令。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>确保已挂载 <code>debugfs</code>。如果尚未挂载，可运行以下命令来挂载 <code>debugfs</code>:</p>
<p><code>mount -t debugfs none /sys/kernel/debug</code></p>
</blockquote></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/dwc3</span><br></span></code></pre></div></div>
<p>以下是可用于验证 xHCI/gadget 协议栈/USB Type-C 连接器系统软件接口 (UCSI) 中的数据传输的跟踪。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_alloc_request  dwc3_event              dwc3_gadget_generic_cmd  enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_complete_trb   dwc3_free_request       dwc3_gadget_giveback     filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_ctrl_req       dwc3_gadget_ep_cmd      dwc3_prepare_trb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_ep_dequeue     dwc3_gadget_ep_disable  dwc3_readl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwc3_ep_queue       dwc3_gadget_ep_enable   dwc3_writel</span><br></span></code></pre></div></div>
<p>要列出 xHCI/主机控制器驱动程序 (HCD) 中的跟踪数据，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/xhci-hcd</span><br></span></code></pre></div></div>
<p>以下是可用于验证 xHCI/HCD 中数据传输的跟踪。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enable                            xhci_handle_cmd_config_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filter                            xhci_handle_cmd_disable_slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_add_endpoint                 xhci_handle_cmd_reset_dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_address_ctrl_ctx             xhci_handle_cmd_reset_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_address_ctx                  xhci_handle_cmd_set_deq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_alloc_dev                    xhci_handle_cmd_set_deq_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_alloc_virt_device            xhci_handle_cmd_stop_ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_configure_endpoint           xhci_handle_command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_configure_endpoint_ctrl_ctx  xhci_handle_event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_alloc_request            xhci_handle_port_status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_free_request             xhci_handle_transfer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_gadget_ep_queue          xhci_hub_status_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_giveback_request         xhci_inc_deq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_handle_event             xhci_inc_enq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_handle_transfer          xhci_queue_trb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbc_queue_request            xhci_ring_alloc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_address                  xhci_ring_ep_doorbell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_cancel_urb               xhci_ring_expansion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_context_change           xhci_ring_free</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_init                     xhci_ring_host_doorbell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_quirks                   xhci_setup_addressable_virt_device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_reset_ep                 xhci_setup_device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_dbg_ring_expansion           xhci_setup_device_slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_discover_or_reset_device     xhci_stop_device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_free_dev                     xhci_urb_dequeue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_free_virt_device             xhci_urb_enqueue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_get_port_status              xhci_urb_giveback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xhci_handle_cmd_addr_dev</span><br></span></code></pre></div></div>
<p>请运行以下命令，以便列出 USB 视频类 (UVC) gadget 驱动程序的可用事件。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/gadget</span><br></span></code></pre></div></div>
<p>随即显示以下输出。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enable                      usb_gadget_activate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filter                      usb_gadget_clear_selfpowered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_alloc_request        usb_gadget_connect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_clear_halt           usb_gadget_deactivate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_dequeue              usb_gadget_disconnect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_disable              usb_gadget_frame_number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_enable               usb_gadget_giveback_request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_fifo_flush           usb_gadget_set_remote_wakeup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_fifo_status          usb_gadget_set_selfpowered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_free_request         usb_gadget_vbus_connect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_queue                usb_gadget_vbus_disconnect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_set_halt             usb_gadget_vbus_draw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_set_maxpacket_limit  usb_gadget_wakeup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usb_ep_set_wedge</span><br></span></code></pre></div></div>
<p>如需列出 UCSI 驱动程序中的可用事件，可运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/tracing/events/ucsi</span><br></span></code></pre></div></div>
<p>随即显示以下输出。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enable  ucsi_connector_change  ucsi_register_port  ucsi_run_command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filter  ucsi_register_altmode  ucsi_reset_ppm</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="usb-寄存器打印">USB 寄存器打印<a href="#usb-寄存器打印" class="hash-link" aria-label="Direct link to USB 寄存器打印" title="Direct link to USB 寄存器打印">​</a></h4>
<p>USB <code>debugfs</code> 提供以下信息，下面以 Type-C 接口为例。</p>
<ul>
<li>
<p>工作模式</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/usb/a600000.usb/mode # Type-C 接口</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>USB 2.0 Type-A 的工作模式<code>cat /sys/kernel/debug/usb/8c00000.usb/qcom_usb2_0_mode</code></p>
</blockquote></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">device</span><br></span></code></pre></div></div>
</li>
<li>
<p>设备模式下所有端点的状态和传输环形缓冲区 (TRB) 队列。</p>
</li>
<li>
<p>当前链路状态。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/usb/a600000.usb/link_state</span><br></span></code></pre></div></div>
<p>示例输出 </p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Sleep</span><br></span></code></pre></div></div>
</li>
<li>
<p>列出处理器 (LSP) dump。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/usb/a600000.usb/lsp_dump</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[0] = 0x40000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[1] = 0x00003a80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[2] = 0x38200000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[3] = 0x00802000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[4] = 0x126f1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[5] = 0x3a800018</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[6] = 0x00000a80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[7] = 0xfc03f14a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[8] = 0x0b803fff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[9] = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[10] = 0x000000f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[11] = 0x000000f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[12] = 0x000000f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[13] = 0x000000f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[14] = 0x000000f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLSP[15] = 0x000000f8</span><br></span></code></pre></div></div>
</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /sys/kernel/debug/usb/a600000.usb</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ep0in    ep11out  ep14in   ep1out  ep4in   ep6out  ep9in       regdump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ep0out   ep12in   ep14out  ep2in   ep4out  ep7in   ep9out      testmode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ep10in   ep12out  ep15in   ep2out  ep5in   ep7out  link_state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ep10out  ep13in   ep15out  ep3in   ep5out  ep8in   lsp_dump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ep11in   ep13out  ep1in    ep3out  ep6in   ep8out  mode</span><br></span></code></pre></div></div>
<p><code>regdump</code> 命令提供以下寄存器的寄存器空间的当前状态： </p>
<ul>
<li>
<p>设备模式的寄存器，例如 DCTL、DSTS 和 DCFG</p>
</li>
<li>
<p>全局寄存器，例如 GCTL 和 GSTS</p>
</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/kernel/debug/usb/a600000.usb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat regdump</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GSBUSCFG0 = 0x2222000e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GSBUSCFG1 = 0x00001700</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GTXTHRCFG = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GRXTHRCFG = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GCTL = 0x00102000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GEVTEN = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GSTS = 0x7e800000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUCTL1 = 0x810c1802</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GSNPSID = 0x5533330a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GGPIO = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUID = 0x00060500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUCTL = 0x0d00c010</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GBUSERRADDR0 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GBUSERRADDR1 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP0 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP1 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GHWPARAMS0 = 0x4020400a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGFIFOSPACE = 0x00420000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGLTSSM = 0x41090658</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GDBGBMU = 0x20300000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP_HS0 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP_HS1 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP_FS0 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GPRTBIMAP_FS1 = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUCTL2 = 0x0198440d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VER_NUMBER = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VER_TYPE = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUSB2PHYCFG(0) = 0x00002400</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUSB2I2CCTL(0) = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUSB2PHYACC(0) = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUSB3PIPECTL(0) = 0x030e0002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GTXFIFOSIZ(0) = 0x00000042</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GRXFIFOSIZ(0) = 0x00000305</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GEVNTADRLO(0) = 0xfffff000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GEVNTADRHI(0) = 0x0000000f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GEVNTSIZ(0) = 0x00001000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GEVNTCOUNT(0) = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GHWPARAMS8 = 0x000007ea</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUCTL3 = 0x00010000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GFLADJ = 0x8c80c8a0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DCFG = 0x00cc08b4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DCTL = 0x8cf00a00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEVTEN = 0x00000257</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DSTS = 0x008a5200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DGCMDPAR = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DGCMD = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DALEPENA = 0x0000000f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEPCMDPAR2(0) = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEPCMDPAR1(0) = 0xffffe000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEPCMDPAR0(0) = 0x0000000f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEPCMD(0) = 0x00000006</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OCFG = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OCTL = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OEVT = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OEVTEN = 0x00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OSTS = 0x00000000</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="主机-sysfs-查询">主机 sysfs 查询<a href="#主机-sysfs-查询" class="hash-link" aria-label="Direct link to 主机 sysfs 查询" title="Direct link to 主机 sysfs 查询">​</a></h4>
<p>要查看总线详细信息，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lsusb</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus 001 Device 002: ID 03f0:134a HP, Inc Optical Mouse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br></span></code></pre></div></div>
<p>请运行以下命令，以便列出当前目录的内容。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/bus/usb/devices/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1-0:1.0  1-1  1-1:1.0  2-0:1.0  usb1  usb2</span><br></span></code></pre></div></div>
<p>要查看有关 USB 设备的详细信息，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/usb/devices</span><br></span></code></pre></div></div>
<p>示例输出：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=01 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=480  MxCh= 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 2.00 Cls=09(hub  ) Sub=00 Prot=01 MxPS=64 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=1d6b ProdID=0002 Rev= 6.05</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=Linux 6.5.0-rc4 xhci-hcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=xHCI Host Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=xhci-hcd.0.auto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=01 Lev=01 Prnt=01 Port=00 Cnt=01 Dev#=  2 Spd=1.5  MxCh= 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 2.00 Cls=00(&gt;ifc ) Sub=00 Prot=00 MxPS= 8 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=03f0 ProdID=134a Rev= 1.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=PixArt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=HP USB Optical Mouse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=a0 MxPwr=100mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=03(HID  ) Sub=01 Prot=02 Driver=usbhid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=10ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T:  Bus=02 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=5000 MxCh= 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">D:  Ver= 3.00 Cls=09(hub  ) Sub=00 Prot=03 MxPS= 9 #Cfgs=  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P:  Vendor=1d6b ProdID=0003 Rev= 6.05</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Manufacturer=Linux 6.5.0-rc4 xhci-hcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  Product=xHCI Host Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">S:  SerialNumber=xhci-hcd.0.auto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="相机串行接口csi">相机串行接口（CSI）<a href="#相机串行接口csi" class="hash-link" aria-label="Direct link to 相机串行接口（CSI）" title="Direct link to 相机串行接口（CSI）">​</a></h2>
<p>目前 RUBIK Pi 3 已经兼容树莓派官方的三款摄像头。下表显示了每个摄像头模块支持的分辨率：</p>
<table><thead><tr><th>分辨率</th><th>宽高比</th><th>IMX477</th><th>IMX708</th><th>IMX219</th></tr></thead><tbody><tr><td>4056 x 3040</td><td>4:3</td><td>是</td><td>否</td><td>否</td></tr><tr><td>4608 x 2592</td><td>16:9</td><td>否</td><td>是</td><td>否</td></tr><tr><td>3280 x 2464</td><td>4:3</td><td>否</td><td>否</td><td>是</td></tr><tr><td>1920 x 1080</td><td>16:9</td><td>是</td><td>否</td><td>否</td></tr><tr><td>1632 x 1224</td><td>4:3</td><td>否</td><td>否</td><td>是</td></tr></tbody></table>
<ul>
<li>
<p>Raspberry Pi High Quality Camera（IMX477/M12 Mount）<a href="https://www.raspberrypi.com/products/raspberry-pi-high-quality-camera/" target="_blank" rel="noopener noreferrer">购买链接</a></p>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155508-39f4a9abef201de51ed4d22035933e96.jpg" width="4096" height="3072" class="img_ev3q"></p>
</li>
<li>
<p>Raspberry Pi Camera Module 2 (IMX219) <a href="https://www.raspberrypi.com/products/camera-module-v2/" target="_blank" rel="noopener noreferrer">购买链接</a></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>目前 RUBIK Pi 3 暂时只支持标准版 Module 2 摄像头，不支持广角（Wide）、夜光（NoIR）版本。</p>
</blockquote></div></div>
</li>
<li>
<p>Raspberry Pi Camera Module 3 (IMX708) <a href="https://www.raspberrypi.com/products/camera-module-3/" target="_blank" rel="noopener noreferrer">购买链接</a></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>目前 RUBIK Pi 3 暂时只支持标准版 Module 3 摄像头，不支持广角（Wide）、夜光（NoIR）版本。当前软件版本暂不支持 Module 3 摄像头的 AF 自动对焦功能。</p>
</blockquote></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="摄像头排线安装">摄像头排线安装<a href="#摄像头排线安装" class="hash-link" aria-label="Direct link to 摄像头排线安装" title="Direct link to 摄像头排线安装">​</a></h3>
<a id="cameracable"></a>
<p>RUBIK Pi 3 支持的摄像头 FPC 为 22 pin，0.5mm 间距，厚度 0.3±0.05mm。可以兼容 <a href="https://www.raspberrypi.com/products/camera-cable/" target="_blank" rel="noopener noreferrer">树莓派 5 同规格摄像头FPC</a>。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>严禁在板子未断电的情况下插拔摄像头，否则非常容易烧坏摄像头模组。</p>
</blockquote></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155515-334eb55e6c58b28d65b5ce1379422347.jpg" width="4096" height="3072" class="img_ev3q"></p>
<ol>
<li>
<p>向上拉开连接器的锁扣部分：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155519-bc2c46b5faa0ce10b03a185e5d52d6e3.jpg" width="4096" height="3072" class="img_ev3q"></p>
</li>
<li>
<p>插入 FPC，注意接触面朝向板内：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155503-20e965abe4c5f3b7be69896d763ec9eb.jpg" width="4096" height="3072" class="img_ev3q"></p>
</li>
<li>
<p>按下锁扣，确认 FPC 稳定没有松动：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155500-2e5916cec6941b2878120fa2e6686eb7.jpg" width="4096" height="3072" class="img_ev3q"></p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="摄像头使用方法">摄像头使用方法<a href="#摄像头使用方法" class="hash-link" aria-label="Direct link to 摄像头使用方法" title="Direct link to 摄像头使用方法">​</a></h3>
<p>将摄像头插入，下图 13 和 14 处</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-124-f8c3c5533751ddd8dfbfc4bd201144f5.png" width="924" height="730" class="img_ev3q"></p>
<p>如下为实物连接图：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155452-0c6d27e21c38ab964508a570da3cd46d.jpg" width="4096" height="3072" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>暂时无法支持两个 IMX708 在4608x2592 分辨率下同时运行。</p>
</blockquote></div></div>
<ul>
<li>前提准备<!-- -->
<ol>
<li>
<p>将 Qualcomm 和魔方派公共个人软件包档案 (PPA) 添加到您的魔方派 3 Ubuntu 软件源。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo add-apt-repository ppa:ubuntu-qcom-iot/qcom-noble-ppa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">su root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;deb http://apt.rubikpi.ai ppa main&quot; &gt;&gt; /etc/apt/sources.list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/20250603-191934-6e0ebd5aaa3ca315d7d80af750e27535.jpg" width="1008" height="450" class="img_ev3q"></p>
</li>
<li>
<p>更新并安装依赖项。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update &amp;&amp; sudo apt upgrade</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install qcom-ib2c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install qcom-camera-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install qcom-camx</span><br></span></code></pre></div></div>
</li>
<li>
<p>重启。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo reboot</span><br></span></code></pre></div></div>
</li>
<li>
<p>安装 gstreamer.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install  gstreamer1.0-qcom-sample-apps</span><br></span></code></pre></div></div>
</li>
<li>
<p>重启。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo reboot</span><br></span></code></pre></div></div>
</li>
<li>
<p>执行如下命令，安装 rubikpi3-cameras.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod -R 755 /usr/bin/camera</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install rubikpi3-cameras</span><br></span></code></pre></div></div>
</li>
</ol>
</li>
<li>拍照测试<!-- -->
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod -R 777 /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo -i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo enableNCSService=FALSE &gt;&gt; /var/cache/camera/camxoverridesettings.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># CAM1, 生成物为 /opt/img0_123.jpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 -e qtiqmmfsrc camera=0 ! video/x-raw,format=NV12,width=1280,height=720,framerate=30/1 ! queue ! jpegenc ! queue ! multifilesink location=/opt/img0_%d.jpg max-files=5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># CAM2, 生成物为 /opt/img1_123.jpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gst-launch-1.0 -e qtiqmmfsrc camera=1 ! video/x-raw,format=NV12,width=1280,height=720,framerate=30/1 ! queue ! jpegenc ! queue ! multifilesink location=/opt/img1_%d.jpg max-files=5</span><br></span></code></pre></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="摄像头故障排除">摄像头故障排除<a href="#摄像头故障排除" class="hash-link" aria-label="Direct link to 摄像头故障排除" title="Direct link to 摄像头故障排除">​</a></h3>
<p>如果摄像头无法显示或捕捉图像，请检查以下内容：</p>
<ol>
<li>
<p>检查摄像头模块连接</p>
<p>请参阅 <a href="#cameracable">摄像头排线安装</a>。</p>
</li>
<li>
<p> 使用以下命令收集日志</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">journalctl -f &gt; /opt/log.txt</span><br></span></code></pre></div></div>
<p>在日志中搜索 &quot;probe success&quot; 。Probe success 意味着摄像头模块已通电并响应 I2C 控制。如果特定传感器没有 &quot;probe success&quot; 日志，则可能是柔性电缆连接或摄像头模块的问题。</p>
<p>以下日志指示探测到一个 IMX477：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[   80.645992] CAM_INFO: CAM-SENSOR: cam_sensor_driver_cmd: 939: Probe success,slot:7,slave_addr:0x34,sensor_id:0x477, is always on: 0</span><br></span></code></pre></div></div>
</li>
<li>
<p>检查摄像头传感器驱动程序命令</p>
<p>使用 <code>journalctl -f &gt; /opt/log.txt</code>命令收集日志并搜索 &quot;cam_sensor_driver_cmd&quot; 。&quot;CAM_START_DEV Success&quot; 表示摄像头传感器流式传输开始。&quot;CAM_STOP_DEV Success&quot; 表示摄像头传感器流式传输停止。例如：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   81.172814] CAM_INFO: CAM-SENSOR: cam_sensor_driver_cmd: 1129: CAM_START_DEV Success, sensor_id:0x477,sensor_slave_addr:0x34</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stop:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   88.905241] CAM_INFO: CAM-SENSOR: cam_sensor_driver_cmd: 1157: CAM_STOP_DEV Success, sensor_id:0x477,sensor_slave_addr:0x34</span><br></span></code></pre></div></div>
</li>
<li>
<p>检查传感器流式传输</p>
<p>启用 CSID SOF/EOF IRQ 日志，随后执行摄像头出流命令</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mount -o rw,remount /usr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount -t debugfs none /sys/kernel/debug/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 0x8 &gt; /sys/module/camera/parameters/debug_mdl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 3 &gt;/sys/kernel/debug/camera_ife/ife_csid_debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; /sys/kernel/tracing/tracing_on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; /sys/kernel/tracing/events/camera/cam_log_debug/enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 2 &gt; /sys/module/camera/parameters/debug_type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/tracing/trace_pipe &gt; trace.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>捕获的日志有助于提供有关 SOF 和 EOF 的详细信息。在日志 &quot;trace.txt&quot; 中搜索 &quot;irq_status_ipp&quot;。</p>
<ul>
<li>
<p>BIT12(0x1000)表示 SOF 数据包</p>
</li>
<li>
<p>BIT9(0x200)表示 EOF 数据包。</p>
</li>
</ul>
<p>日志如下所示：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;idle&gt;-0       [000] d.h1. 19287.546764: cam_log_debug:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CAM_DBG: CAM-ISP: cam_ife_csid_irq: 4996: irq_status_ipp = 0x1110 cam-server-25604     [000] dNH.. 19287.561705: cam_log_debug:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CAM_DBG: CAM-ISP: cam_ife_csid_irq: 4996: irq_status_ipp = 0xee8</span><br></span></code></pre></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hdmi-out">HDMI OUT<a href="#hdmi-out" class="hash-link" aria-label="Direct link to HDMI OUT" title="Direct link to HDMI OUT">​</a></h2>
<p>RUBIK Pi 3 的 HDMI 接口为下图 9。</p>
<p>RUBIK Pi 3 HDMI 参数信息：</p>
<ul>
<li>
<p>HDMI 1.4</p>
</li>
<li>
<p>最高 3840 x 2160 分辨率 @ 30 fps</p>
</li>
<li>
<p>DSI 0 to HDMI (LT9611)</p>
</li>
<li>
<p>支持 CEC</p>
</li>
<li>
<p>支持分辨率自适应</p>
</li>
<li>
<p>支持热插拔</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/image-140-f8c3c5533751ddd8dfbfc4bd201144f5.png" width="924" height="730" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cec">CEC<a href="#cec" class="hash-link" aria-label="Direct link to CEC" title="Direct link to CEC">​</a></h3>
<p>HDMI CEC（Consumer Electronics  Control，消费者电子控制）是 HDMI 标准中的一项功能，旨在通过单一的 HDMI 连接线实现多设备之间的互联与统一控制。具体来说，CEC 允许连接的设备通过专用的 CEC 引脚进行通信，从而实现例如通过一个遥控器控制多台设备的功能。</p>
<p>使用下面命令 安装 cec-client 工具。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install cec-utils</span><br></span></code></pre></div></div>
<p>将 HDMI 线连接到电视后，可使用下面命令查看电视是否支持 CEC：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;scan&#x27; | cec-client -s -d 1</span><br></span></code></pre></div></div>
<p>若支持 CEC 将会有如下输出:</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">opening a connection to the CEC adapter...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">requesting CEC bus information ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CEC bus information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">===================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">device #0: TV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address:       0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">active source: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor:        Sony</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">osd string:    TV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CEC version:   1.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">power status:  standby</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">language:      eng</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">device #1: Recorder 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address:       1.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">active source: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor:        Pulse Eight</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">osd string:    CECTester</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CEC version:   1.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">power status:  on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">language:      eng</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">device #4: Playback 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address:       3.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">active source: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vendor:        Sony</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">osd string:    PlayStation 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CEC version:   1.3a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">power status:  standby</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">language:      ???</span><br></span></code></pre></div></div>
<p>若电视支持 CEC 功能，可在 RUBIK Pi 3 中使用下面命令控制电视音量的加减：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;volup&#x27; | cec-client -t p -s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;voldown&#x27; | cec-client -t p -s</span><br></span></code></pre></div></div>
<p>更多 cec-client 使用方法，可使用 <code>-h</code> 参数进行查看：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-141-755f42f67b1689e65e92337c6d56190a.png" width="727" height="509" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hdmi-out-触摸屏">HDMI OUT 触摸屏<a href="#hdmi-out-触摸屏" class="hash-link" aria-label="Direct link to HDMI OUT 触摸屏" title="Direct link to HDMI OUT 触摸屏">​</a></h3>
<p>RUBIK Pi 3 默认支持 1024*600P 分辨率的 HDMI OUT 触摸屏，如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/img_v3_02h3_18251d67-83e7-498c-b056-5a11783ed13g-cf9d3096203084929801b1f38ba084a4.jpg" width="8192" height="6144" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>上图中使用的屏幕为 <a href="https://detail.tmall.com/item.htm?abbucket=12&amp;id=683025543197&amp;rn=92499216a472de3107f9541a1b160dc3&amp;spm=a1z10.5-b-s.w4011-25285306736.152.50aa1c712FMfOS&amp;skuId=5055110246880" target="_blank" rel="noopener noreferrer">7 寸 IPS 高清触摸屏幕</a>。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hdmi-out-调试">HDMI OUT 调试<a href="#hdmi-out-调试" class="hash-link" aria-label="Direct link to HDMI OUT 调试" title="Direct link to HDMI OUT 调试">​</a></h3>
<p>RUBIK Pi 3 使用的是 LT9611 这款 DSI-to-HDMI 桥接芯片。</p>
<p>下表列 HDMI 桥接芯片所需的配置。</p>
<table><thead><tr><th>说明</th><th>DTSI 节点</th></tr></thead><tbody><tr><td>将 DSI-to-HDMI 桥接面板设置为 Primary</td><td><code>&amp;sde_dsi { qcom, dsi-default-panel = &lt;&amp;dsi_ext_bridge_1080p&gt;;</code></td></tr><tr><td>为桥接芯片配置基准电源条目</td><td><code>&amp;sde_dsi { vddio-supply = &lt;&amp;vreg_18c_ip62&gt;; vdda-9p9-supply = &lt;&amp;vreg_11oc_9p88&gt;; vdda-9p9-supply = &lt;&amp;vreg_11oc_9p88&gt;;</code></td></tr><tr><td>为桥接芯片配置面板复位 GPIO</td><td><code>lt9611: lt,lt9611 { reset-options = &lt;&amp;tlmm 21 0&gt;;}</code></td></tr><tr><td>在外部桥接模式下配置 DSI 主机驱动程序以使用第三方 DSI-to-HDMI 桥接芯片</td><td><code>qcom,mdss-dsi-ext-bridge-mode;</code></td></tr></tbody></table>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>执行 <code>sudo passwd root</code> 命令根据提示修改 root 帐号密码，使用 <code>su root</code> 命令切换到 root 用户。</p>
</blockquote></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取-lt9611-日志">获取 lt9611 日志<a href="#获取-lt9611-日志" class="hash-link" aria-label="Direct link to 获取 lt9611 日志" title="Direct link to 获取 lt9611 日志">​</a></h4>
<p>要获取 LT9611 日志，请运行以下命令：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dmesg | grep lt9611</span><br></span></code></pre></div></div>
<p>查看 log，出现下面的字样代表 HDMI OUT 可以正常运行。</p>
<p>这段日志记录了 LT9611 芯片的初始化和 HDMI 连接过程，从固件版本检测到 CEC 初始化，芯片启动正常。</p>
<ol>
<li>
<p>芯片的固件版本是 0xe2.17.02。这表示芯片初始化时，驱动成功读取了版本信息。</p>
</li>
<li>
<p>LT9611 的 CEC（消费电子控制）功能适配器成功注册。</p>
</li>
<li>
<p>CEC 初始化完成，表明 LT9611 的 CEC 模块已经可以正常工作。</p>
</li>
<li>
<p>芯片成功读取了 HPD（热插拔检测）状态，并且会有返回值，表示确认 HDMI 设备接入。</p>
</li>
<li>
<p>芯片检测到视频信号参数：水平分辨率 1920（像素），垂直分辨率 1080（像素），像素时钟频率 148500 kHz（148.5 MHz）。这对应的是 1080p 分辨率（全高清），60Hz 刷新率的典型配置。</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[    5.492765] lt9611 9-0039: LT9611 revision: 0xe2.17.02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    5.570258] lt9611 9-0039: CEC adapter registered</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    5.582944] lt9611 9-0039: CEC init success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    8.233028] lt9611 9-0039: success to read hpd status: 13</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    8.233044] lt9611_device_connect_status_notify: send msg[Hdmi Connection] ret[32]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    8.345015] lt9611 9-0039: hdisplay=1920, vdisplay=1080, clock=148500 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[    8.836662] lt9611 9-0039: video check: hactive_a=1920, hactive_b=1920, vactive=1080, v_total=1125, h_total_sysclk=401, mipi_video_format=170</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取-dsi-日志">获取 DSI 日志<a href="#获取-dsi-日志" class="hash-link" aria-label="Direct link to 获取 DSI 日志" title="Direct link to 获取 DSI 日志">​</a></h4>
<p>我们也可以通过输出的 DSI 信息进行调试，DSI 指的是 Display Serial Interface（显示串行接口），通常与移动设备或嵌入式系统的显示驱动（如 MIPI DSI）相关。</p>
<p>这个命令用来查看与显示接口（DSI）相关的内核日志，通常用于调试显示驱动或硬件问题。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dmesg | grep dsi</span><br></span></code></pre></div></div>
<p>输出结果示例：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[    6.831249] i2c 9-0039: Fixed dependency cycle(s) with /soc@0/display-subsystem@ae00000/dsi@ae9400</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   15.070444] lt9611 9-0039: failed to find dsi host</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   17.855362] lt9611 9-0039: failed to find dsi host</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   18.007167] platform ae01000.display-controller: Fixed dependency cycle(s) with /soc@0/display-su0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   18.014168] platform ae01000.display-controller: Fixed dependency cycle(s) with /soc@0/display-su0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   18.014317] lt9611 9-0039: Fixed dependency cycle(s) with /soc@0/display-subsystem@ae00000/dsi@ae0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   18.014460] platform ae94000.dsi: Fixed dependency cycle(s) with /soc@0/geniqup@ac0000/i2c@a840009</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   18.014514] platform ae94000.dsi: Fixed dependency cycle(s) with /soc@0/display-subsystem@ae000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   18.372993] lt9611 9-0039: failed to find dsi host</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   18.803189] msm_dpu ae01000.display-controller: bound ae94000.dsi (ops dsi_ops [msm])</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取调压器信息">获取调压器信息<a href="#获取调压器信息" class="hash-link" aria-label="Direct link to 获取调压器信息" title="Direct link to 获取调压器信息">​</a></h4>
<p>要检查调压器状态和电压，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/regulator/regulator_summary</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取接口信息">获取接口信息<a href="#获取接口信息" class="hash-link" aria-label="Direct link to 获取接口信息" title="Direct link to 获取接口信息">​</a></h4>
<p>要检索调试 dump 输出（显示接口编号、VSync 计数、欠载计数和接口模式），请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/dri/0/encoder*/status</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">intf:1  wb:-1  vsync:    2580     underrun:       0    frame_done_cnt:0mode: INTF_MODE_VIDEO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">intf:-1  wb:2  vsync:       0     underrun:       0    frame_done_cnt:0mode: INTF_MODE_WB_LINE</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="获取常规-dpu-调试信息">获取常规 DPU 调试信息<a href="#获取常规-dpu-调试信息" class="hash-link" aria-label="Direct link to 获取常规 DPU 调试信息" title="Direct link to 获取常规 DPU 调试信息">​</a></h4>
<p>常见的 DPU 调试信息说明如下：</p>
<p>要检查 DPU 时钟速率，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/debug/clk/clk_summary | grep disp_cc</span><br></span></code></pre></div></div>
<p>将 DPU 设置为性能模式</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /sys/kernel/debug/dri/0/debug/core_perf/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; perf_mode</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="displayport">DisplayPort<a href="#displayport" class="hash-link" aria-label="Direct link to DisplayPort" title="Direct link to DisplayPort">​</a></h2>
<p>RUBIK Pi 3 拥有 1 个 USB Type-C 接口的 DisplayPort，如下图 5。</p>
<p>DP 的参数如下：</p>
<ul>
<li>
<p>3840 × 2160 分辨率 @ 60 fps</p>
</li>
<li>
<p>单流传输 (Single stream transport)</p>
</li>
<li>
<p>DisplayPort 和 USB 3.0 的并发功能</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/image-139-c5902575896b6b747e3c2ea93a09e043.png" width="924" height="730" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>在 Ubuntu24.04 V1.0.0 版本中，暂不支持 DP 功能，DP 功能将在后续的版本中支持。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wi-fi">Wi-Fi<a href="#wi-fi" class="hash-link" aria-label="Direct link to Wi-Fi" title="Direct link to Wi-Fi">​</a></h3>
<p>Wi-Fi 是一种使用 IEEE 802.11 协议的无线网络技术。它允许智能手机、可穿戴设备、笔记本电脑、台式机和其他消费电子产品等电子设备在没有物理电缆的情况下连接到互联网。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="工作频段">工作频段<a href="#工作频段" class="hash-link" aria-label="Direct link to 工作频段" title="Direct link to 工作频段">​</a></h4>
<p> AP6256 Wi-Fi 模块支持 2.4 GHz、5 GHz 工作频段。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="工作模式">工作模式<a href="#工作模式" class="hash-link" aria-label="Direct link to 工作模式" title="Direct link to 工作模式">​</a></h4>
<p>Wi-Fi 是一种使用 IEEE 802.11 协议的无线网络技术。它允许智能手机、可穿戴设备、笔记本电脑、台式机和其他消费电子产品等电子设备在没有物理电缆的情况下连接到互联网。</p>
<p>Wi-Fi 软件在以下模式下运行：</p>
<table><thead><tr><th>模式</th><th>说明</th></tr></thead><tbody><tr><td>STA 模式</td><td>在 STA 模式下，设备连接到 Wi-Fi 网络中的接入点，并与网络中的其他设备进行通信。此模式是 Wi-Fi 连接中的无线设备的标准模式。</td></tr><tr><td>热点模式</td><td>热点模式使设备能够使用蜂窝链路 (LTE) 向 Wi-Fi 客户端提供回程 (Internet) 连接。该设备通过其轻量级热点接口建立此连接。在热点模式下，设备可以：与连接到同一热点的其他 Wi-Fi 客户端通信。与热点设备通信。共享设备的 WAN 连接。</td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="sta-模式">STA 模式<a href="#sta-模式" class="hash-link" aria-label="Direct link to STA 模式" title="Direct link to STA 模式">​</a></h5>
<p>在 STA 模式（Station）下，设备可连接到一个已经存在的无线网络，以便访问网络资源或互联网。</p>
<ul>
<li>在用户界面连接</li>
</ul>
<p>在 RUBIK Pi 中，连接显示器，点击桌面右上角的图标，在弹出的窗口中点 Wi-Fi 图标，按照提示连接对应的 Wi-Fi。 Wi-Fi 连接成功后，会在右上角显示 Wi-Fi 图标，如下所示。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/20250603-201623-472b153dd68ab0a823fedb2e4770dc91.jpg" width="329" height="396" class="img_ev3q"></p>
<ul>
<li>使用命令行连接</li>
</ul>
<ol>
<li>使用命令扫描 Wi-Fi</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmcli dev wifi list 2&gt;&amp;1 | less</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/image-143-f34c06c3165eb402a6e8d48f56c6f163.png" width="1004" height="231" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>按下 <code>q</code> 退出</p>
</blockquote></div></div>
<ol start="2">
<li>使用命令连接 Wi-Fi</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo nmcli dev wifi connect &lt;WiFi-SSID&gt; password &lt;WiFi-password&gt;</span><br></span></code></pre></div></div>
<p>例如，运行命令</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo nmcli dev wifi connect rubikpiwifi password 123456789</span><br></span></code></pre></div></div>
<p>其中，Wi-Fi SSID 为 <code>rubikpiwifi</code>，Wi-Fi 密码为 <code>123456789</code>。 </p>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Device &#x27;wlan0&#x27; successfully activated with &#x27;e8b98f24-3f23-4742-8aa3-0d37c5ee6564&#x27;.</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>如果您在运行命令时看到网络错误消息，请运行以下命令之一来触发 Wi-Fi 扫描并验证目标 AP。 </p>
<ul>
<li>
<p><code>nmcli dev wifi list</code></p>
</li>
<li>
<p><code>iw dev wlan0 scan </code>        </p>
</li>
</ul>
</blockquote></div></div>
<ol start="3">
<li>要查看连接状态，请运行以下命令：</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmcli general status</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">STATE  CONNECTIVITY  WIFI-HW  WIFI    WWAN-HW  WWAN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connected  full     enabled  enabled  enabled  enabled</span><br></span></code></pre></div></div>
<ol start="4">
<li>
<p>要验证连接状态，请执行以下步骤：</p>
<ol>
<li>要查看设备状态，请运行以下命令：</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmcli dev status</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DEVICE  TYPE      STATE        CONNECTION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wlan0   wifi      connected    RUbikpiWiFi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eth0    ethernet  unavailable  --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eth1    ethernet  unavailable  --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">can0    can       unmanaged    --</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lo      loopback  unmanaged    --</span><br></span></code></pre></div></div>
<ol start="2">
<li>要查看附加连接信息，请运行以下命令：</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmcli device show wlan0</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GENERAL.DEVICE:                         wlan0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GENERAL.TYPE:                           wifi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GENERAL.HWADDR:                         00:03:7F:12:F7:F7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GENERAL.MTU:                            1500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GENERAL.STATE:                          100 (connected)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GENERAL.CONNECTION:                     QualcommWiFi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GENERAL.CON-PATH:                       /org/freedesktop/NetworkManager/ActiveConnection/5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IP4.ADDRESS[1]:                         192.168.117.130/24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IP4.ADDRESS[2]:                         192.168.117.131/24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IP4.GATEWAY:                            192.168.117.126</span><br></span></code></pre></div></div>
<ol start="3">
<li>通过在 UART 控制台中运行 ifconfig wlan0 命令来验证是否在 wlan0 接口上分配了 IP 地址</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ifconfig wlan0</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>可输入命令 <code>sudo apt install net-tools</code> 安装 ifconfig 命令。</p>
</blockquote></div></div>
<ol start="4">
<li>通过 ping 以下公共 DNS IP：验证 AP 或路由器是否已连接至 Internet</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ping 8.8.8.8</span><br></span></code></pre></div></div>
</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ul>
<li>
<p> 如果您已连接至一个网络，但想要使用另一连接，则可以通过指定 SSID <code>nmcli con down  ssid/uuid</code> 将连接切换为关闭来断开连接。或者，如果您有多个具有相同 SSID 的连接，请使用 UUID。</p>
</li>
<li>
<p>要连接到另一个已保存的连接，只需运行以下命令来传递 <code>nmcli</code> 命令行工具中的 up 选项即可。<code>nmcli con up ssid/uuid</code></p>
</li>
</ul>
</blockquote></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>要退出标准输入 shell，请按 CTRL+C。</p>
</blockquote></div></div>
<p>有关 <code>nmcli</code> 的更多信息，请参阅 <a href="https://www.linux.org/docs/man1/nmcli.html" target="_blank" rel="noopener noreferrer">https://www.linux.org/docs/man1/nmcli.html</a> 和 <a href="https://networkmanager.dev/docs/api/latest/nmcli.html" target="_blank" rel="noopener noreferrer">https://networkmanager.dev/docs/api/latest/nmcli.html</a></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="热点模式">热点模式<a href="#热点模式" class="hash-link" aria-label="Direct link to 热点模式" title="Direct link to 热点模式">​</a></h5>
<p>AP 模式（Access Point）即无线接入热点模式，是一个无线网络的创建者，是网络的中心节点，一般家庭或办公室使用的无线网络路由器就是一个 AP，下面是 AP 的创建步骤：</p>
<ul>
<li>
<p>开启 AP</p>
<ul>
<li>
<p>创建或修改 <em>/opt/hostapd.conf </em> 文件：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ctrl_interface=/var/run/hostapd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">driver=nl80211</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ieee80211n=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface=wlan1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hw_mode=a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">channel=36</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">beacon_int=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtim_period=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssid=RUBIKPi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_algs=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ap_isolate=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ignore_broadcast_ssid=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpa=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpa_key_mgmt=WPA-PSK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rsn_pairwise=CCMP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wpa_passphrase=123456789</span><br></span></code></pre></div></div>
</li>
<li>
<p>执行下面命令开启 AP：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hostapd -B /opt/hostapd.conf # 设置软件AP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 启动动态主机配置协议（DHCP）服务器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brctl addbr br0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brctl addif br0 wlan1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ifconfig br0 192.168.225.1 netmask 255.255.255.0 up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">killall dnsmasq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dnsmasq --conf-file=/etc/dnsmasq.conf --dhcp-leasefile=/var/run/dnsmasq.leases --addn-hosts=/data/hosts --pid-file=/var/run/dnsmasq.pid -i br0 -I lo -z --dhcp-range=br0,192.168.225.20,192.168.225.60,255.255.255.0,43200 --dhcp-hostsfile=/data/dhcp_hosts --dhcp-option-force=6,192.168.225.1 --dhcp-script=/bin/dnsmasq_script.sh</span><br></span></code></pre></div></div>
</li>
<li>
<p>若要与 hostapd_cli 建立连接，可使用下面命令</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hostapd_cli -i wlan1 -p /var/run/hostapd</span><br></span></code></pre></div></div>
</li>
</ul>
<p>在 <code>hostapd_cli</code> 控制台中监视 Wi-Fi STA 连接通知，例如 <code>AP-STA-CONNECTED</code>、 <code>EAPOL-4WAY-HS-COMPLETED</code></p>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@rubikpi:~# hostapd_cli -i wlanl -p /var/run/hostapd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hostapd_cli v2.11-devel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright (c) 2004-2022, Jouni Malinen &lt;j@wl.fi&gt; and contributors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This software may be distributed under the terms of the BSD License. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">See README for more details.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Interactive mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; &lt;3&gt;AP-STA-CONNECTED aa: a4: fd: 8b: ec: 90</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;3&gt;EAPOL-4WAY-HS-COMPLETED aa: a4: fd: 8b:ec:90</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; list_sta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aa: a4: fd: 8b:ec:90</span><br></span></code></pre></div></div>
</li>
</ul>
<p>若开启 AP 5G 模式前，未使用 STA 连接过 5G Wi-Fi，则需使用如下命令，查看环境中 5G channel 的配置</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iw dev wlan0 scan</span><br></span></code></pre></div></div>
<p>在命令执行结果中通过，primary channel 字段确定当前已被激活 channel，如下所示，channel 字段为 36，将36 写入 <em>/opt/hostapd.conf</em> 文件中的 channel 字段即可</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HT operation:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * primary channel: 36</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * secondary channel offset: above</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * STA channel width: any</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * RIFS: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * HT protection: nonmember</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * non-GF present: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * OBSS non-GF present: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * dual beacon: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * dual CTS protection: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * STBC beacon: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * L-SIG TXOP Prot: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * PCO active: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                * PCO phase: 0</span><br></span></code></pre></div></div>
<ul>
<li>
<p>验证 AP</p>
<p>要验证连接状态，请从其他设备连接到 AP。 </p>
<p>例如，通过执行以下步骤从移动设备连接到 AP：</p>
<ol>
<li>
<p>在移动设备上，转到 Wi-Fi settings。</p>
</li>
<li>
<p>等待 Wi-Fi STA 检测到 AP。</p>
</li>
<li>
<p>选择 AP 并输入在 RUBIK Pi 3 设备上为 AP 配置的相应 <code>wpa_passphrase</code>，然后进行连接。 </p>
</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">state=ENABLED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">phy=phyR freq=2412</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_non_erp=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_no_short_slot_time=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_no_short_preamble=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olbc=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_ht_no_gf=0 num_sta_no_ht=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_ht_20_mhz=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta_ht40_intolerant=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">olbc_ht=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ht_op_mode=0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hw_mode=g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">country_code=US</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">country3=0x20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cac_time_seconds=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cac_time_left_seconds=N/A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">channel=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">edmg_enable=0 edmg_channel=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">secondary_channel=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ieee80211n=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ieee80211ac=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ieee80211ax=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ieee80211be=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">beacon_int=100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtim_period=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ht_caps_info=000c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ht_mcs_bitmask=ffff0000000000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">supported_rates-02 04 0b 16 Oc 12 18 24 30 48 60 6c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_txpower=30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bss[0]=wlan1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bssid[0]=00:03:7f:95:8e:8e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssid [0]=QSoftAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">num_sta[0]=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; |</span><br></span></code></pre></div></div>
<p>要验证连接，在 RUBIK Pi 3 设备的 <code>ssh shell</code> 中 ping 移动设备的 IP 地址。</p>
<p>以下输出表示 Wi-Fi 连接已成功建立，数据传输已开始： </p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1# ping 192.168.1.42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PING 192.168.1.42 (192.168.1.42): 56 data bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.1.42: seq=0 ttl=64 time-11.175 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.1.42: seq=1 ttl=64 time=14.528 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.1.42: seq=2 ttl=64 time=29.735 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.1.42: seq=3 ttl=64 time=223.822 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.1.42: seq-4 ttl=64 time-23.675 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.1.42 ping statistics ---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7 packets transmitted, 5 packets received, 28% packet loss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">round-trip min/avg/max = 11.175/60.587/223.822 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sh-5.1#</span><br></span></code></pre></div></div>
<p>也可以在连接设备的 Settings 中验证 Wi-Fi 连接状态。例如，要获取连接到 RUBIK Pi 3 AP 的移动设备的 IP 地址，执行以下步骤：</p>
</li>
</ul>
<ol>
<li>
<p>导航至 Settings &gt; Wi-Fi。</p>
</li>
<li>
<p>验证 AP 的 SSID。</p>
</li>
</ol>
<ul>
<li>关闭 AP：</li>
</ul>
<p>要停止 AP，在 SSH 中执行以下操作：</p>
<ol>
<li>
<p>通过执行以下步骤停止 hostapd：</p>
<ol>
<li>
<p>要停止 hostapd 过程，可运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">killall hostapd</span><br></span></code></pre></div></div>
</li>
<li>
<p>要禁用接口，可运行以下命令：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ifconfig wlan1 down</span><br></span></code></pre></div></div>
</li>
</ol>
</li>
<li>
<p>请运行以下命令，以便删除 <code>ctrl_interface</code>：</p>
<div class="language-plain text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rm -rf /var/run/hostapd/wlan1</span><br></span></code></pre></div></div>
</li>
</ol>
<p>Wi-Fi 热点成功停止。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="蓝牙">蓝牙<a href="#蓝牙" class="hash-link" aria-label="Direct link to 蓝牙" title="Direct link to 蓝牙">​</a></h3>
<p>蓝牙® 无线技术是一种短距离通信系统，可实现设备之间的无线数据交换。蓝牙技术的主要优势如下：</p>
<ul>
<li>
<p>替代便携式和固定式电子设备的线缆</p>
</li>
<li>
<p>提供稳健、节能且经济高效的解决方案</p>
</li>
<li>
<p>促进解决方案及其应用的灵活性。</p>
</li>
</ul>
<p>在 RUBIK Pi 中，连接显示器，点击桌面右上角的图标，在弹出的窗口中点 Bluetooth 图标，点击 Bluetooth Settings 按照提示连接对应的 设备。 蓝牙连接成功后，会在右上角显示蓝牙图标，如下所示。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/20250603-203717-a76630c0a8e56d5bd1af55cd79e2fc71.jpg" width="328" height="415" class="img_ev3q"></p>
<p> </p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="音频">音频<a href="#音频" class="hash-link" aria-label="Direct link to 音频" title="Direct link to 音频">​</a></h2>
<p>RUBIK Pi 3 目前支持的音接口为：</p>
<ul>
<li>
<p>3.5mm 耳机，下图4。</p>
</li>
<li>
<p>HDMI OUT， 下图9。</p>
</li>
<li>
<p>蓝牙</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/image-133-f8c3c5533751ddd8dfbfc4bd201144f5.png" width="924" height="730" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<ol>
<li>需将 <code>deb http://apt.rubikpi.ai ppa main</code> 追加到 <em>/etc/apt/sources.list</em> 文件中。</li>
<li>执行 <code>apt update</code> 命令更新软件源。</li>
</ol>
</blockquote></div></div>
<p>使用如下命令安装音频相关的软件包, 安装完成后, 重启设备，使能音频。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install rubikpi3-tinyalsa rubikpi3-tinycompress rubikpi3-qcom-agm rubikpi3-qcom-args rubikpi3-qcom-pal \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi3-qcom-audio-ftm rubikpi3-qcom-audioroute rubikpi3-qcom-acdbdata rubikpi3-qcom-audio-node \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi3-qcom-kvh2xml rubikpi3-qcom-pa-bt-audio rubikpi3-qcom-sva-capi-uv-wrapper rubikpi3-qcom-sva-cnn \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi3-qcom-sva-listen-sound-model rubikpi3-qcom-sva-eai rubikpi3-qcom-pa-pal-voiceui rubikpi3-qcom-pa-pal-acd \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi3-qcom-audio-plugin-headers rubikpi3-qcom-dac-mer-testapp rubikpi3-qcom-dac-plugin rubikpi3-qcom-mercury-plugin \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi3-pulseaudio rubikpi3-diag rubikpi3-dsp rubikpi3-libdmabufheap rubikpi3-qcom-vui-interface rubikpi3-qcom-vui-interface-header \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rubikpi3-time-genoff rubikpi3-fastrpc rubikpi3-pa-pal-plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo usermod -aG audio,pulse,plugdev,video,render ubuntu  # ubuntu 表示用户名，可按实际情况修改</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="风扇">风扇<a href="#风扇" class="hash-link" aria-label="Direct link to 风扇" title="Direct link to 风扇">​</a></h2>
<p>RUBIK Pi 3 兼容<a href="https://www.raspberrypi.com/products/active-cooler/" target="_blank" rel="noopener noreferrer">树莓派 5 的散热套件</a>:</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>使用 RUBIK Pi 3 在运行一些高负载或高性能的场景下，需要使用散热措施来保证设备性能稳定，否则会因为 CPU 温度过高而带来降频等性能影响。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="风扇安装">风扇安装<a href="#风扇安装" class="hash-link" aria-label="Direct link to 风扇安装" title="Direct link to 风扇安装">​</a></h3>
<ol>
<li><strong>将散热器背面所有导热硅脂移除</strong>，将下图标记的两块硅脂按 RUBIK Pi 3 的 SoC 及 uMCP 的形状裁下。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/image-132-6184254ebf0db803b2b1f42883b67a6c.png" width="977" height="778" class="img_ev3q"></p>
<p>两块的表面尺寸约为14*12mm和13*11.5mm。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-152-93a23207f663c4548729f553af1b2d80.png" width="2238" height="1780" class="img_ev3q"></p>
<ol start="2">
<li>将裁剪好的两块导热硅脂贴在 RUBIK Pi 3 上对应位置。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/20250220-095205-a9d0e91026c2780da641767b44fd2eac.jpg" width="2179" height="3363" class="img_ev3q"></p>
<ol start="3">
<li>安装散热器，连接风扇排线。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155449-c109a5fd846cc6e02251e95cd7d7ef0f.jpg" width="3072" height="4096" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><blockquote>
<p>建议将风扇安装到 RUBIK Pi 3 上后不要将其取下。拆卸会导致风扇的推针和散热垫退化，并可能导致产品损坏。如果推针损坏或变形，或无法牢固夹住，请停止使用风扇。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="风扇控制方法">风扇控制方法<a href="#风扇控制方法" class="hash-link" aria-label="Direct link to 风扇控制方法" title="Direct link to 风扇控制方法">​</a></h3>
<p>RUBIK Pi 3 风扇会根据当前的 CPU 温度自动调整转速，同时也可在 RUBIK Pi 3 中使用下面命令进行手动控制转速，0 和 255 分别表示风扇的最高和最低速度。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/devices/platform/pwm-fan/hwmon/hwmon*/pwm1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 255 &gt;  /sys/devices/platform/pwm-fan/hwmon/hwmon*/pwm1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo 0 &gt;  /sys/devices/platform/pwm-fan/hwmon/hwmon*/pwm1</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>在将风扇转速设置为一个固定值前时，需要使用 <code>systemctl stop rubikpi-thermal</code> 命令将 CPU 热管理关掉。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="led">LED<a href="#led" class="hash-link" aria-label="Direct link to LED" title="Direct link to LED">​</a></h2>
<p>RUBIK Pi 3 上有一个由 PMIC 驱动的 RGB 的三色灯，默认情况下其中的绿色灯被设置为了心跳灯用来反馈系统的运行情况和 CPU 负载情况（CPU 负载大时，心跳灯闪烁频率也跟着变大）。</p>
<p>如下是 LED 灯不同状态时，所指示的状态：</p>
<ul>
<li>
<p>蓝灯长亮：fastboot 模式</p>
</li>
<li>
<p>绿色心跳：正常工作</p>
</li>
<li>
<p>红色心跳：低功耗电源插入（小于 12V  2.25A）</p>
</li>
<li>
<p>快速心跳： CPU 高负荷工作</p>
</li>
<li>
<p>停止心跳：</p>
<ul>
<li>
<p>系统死机</p>
</li>
<li>
<p>进入睡眠</p>
</li>
<li>
<p>正在开机中</p>
</li>
</ul>
</li>
</ul>
<p>可使用如下命令，操作 LED 灯：</p>
<ul>
<li>
<p>关闭心跳灯</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo none &gt; /sys/class/leds/green/trigger</span><br></span></code></pre></div></div>
</li>
<li>
<p>开启心跳灯</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo heartbeat &gt; /sys/class/leds/green/trigger</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置绿灯的亮度（亮度 0 - 511，如下为设置亮度为100）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/class/leds/green/brightness</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置红灯的亮度（亮度 0 - 511，如下为设置亮度为100）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/class/leds/red/brightness</span><br></span></code></pre></div></div>
</li>
<li>
<p>设置蓝灯的亮度（亮度 0 - 511，如下为设置亮度为100）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 100 &gt;  /sys/class/leds/blue/brightness</span><br></span></code></pre></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="以太网">以太网<a href="#以太网" class="hash-link" aria-label="Direct link to 以太网" title="Direct link to 以太网">​</a></h2>
<p>以太网技术旨在使用有线技术以不同的链路速度传输数据。它使用线缆在网络模型（例如局域网 (LAN) 和广域网 (WAN)）中传输数据，实现可靠、安全和更出色的网络连接。</p>
<p>以太网连接集成到 IoT 设备和传感器，使它们能够将数据传输到网络。它根据 IEEE 802.3 标准定义，可为这些设备提供用于与网关通信的标准化接口。</p>
<p>以太网接口为下图 8， RUBIK Pi 3 支持千兆以太网：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-150-f8c3c5533751ddd8dfbfc4bd201144f5.png" width="924" height="730" class="img_ev3q"></p>
<p>接入网线，如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155445-ed72d72b2c84e2fcc81f72fedaed1fb4.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>可在 RUBIK Pi 3 中使用 <code>ifconfig</code> 命令查看网络连接情况，如下图所示，已经成功分配 IP，说明网络连接成功：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-151-614e532aa6f7bfbe30744b242134131b.png" width="711" height="644" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><blockquote>
<p>可输入命令 <code>sudo apt install net-tools</code> 安装 ifconfig 命令。</p>
</blockquote></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="调试以太网">调试以太网<a href="#调试以太网" class="hash-link" aria-label="Direct link to 调试以太网" title="Direct link to 调试以太网">​</a></h3>
<p>可以使用以下日志类型来记录和调试与以太网有关的问题。</p>
<ul>
<li>
<p><code>dmesg</code>：调试与内核驱动程序相关的问题</p>
</li>
<li>
<p><code>tcpdump</code>： 验证数据包传输</p>
</li>
</ul>
<p>要调试在以太网调通期间可能出现的问题，请执行以下操作：</p>
<ol>
<li>
<p>要收集 <code>dmesg</code> 日志并调试与内核驱动程序有关的问题，请运行以下命令：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dmesg &gt; /var/log/dmesg_logs.txt</span><br></span></code></pre></div></div>
</li>
<li>
<p>要收集 <code>tcpdump</code> 日志并验证数据包传输，请运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tcpdump -i any -s 0 -w /var/log/tcpdump.pcap</span><br></span></code></pre></div></div>
</li>
<li>
<p>收集来自 <code>ethtool</code>、<code>ifconfig</code>、<code>netstat</code> 和 IP 路由表的输出以进行调试。</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rtc-电池接口">RTC 电池接口<a href="#rtc-电池接口" class="hash-link" aria-label="Direct link to RTC 电池接口" title="Direct link to RTC 电池接口">​</a></h2>
<p>RTC (Real_Time Clock) 电池接口为下图 1。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-147-f8c3c5533751ddd8dfbfc4bd201144f5.png" width="924" height="730" class="img_ev3q"></p>
<p>接入 RTC 电池， 如下图所示，并将时间写入 RUBIK Pi 3 的系统硬件时钟，可在 RUBIK Pi 3 完全断电后，仍对 RUBIK Pi 3 的系统时间进行保存。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/20250314-155435-502c8df93c10dc9294027fd80babb590.jpg" width="4096" height="3072" class="img_ev3q"></p>
<p>在 RUBIK Pi 3 中将系统时间写入系统硬件时钟方法如下：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo timedatectl set-time &quot;2025-06-03 21:12:11&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo timedatectl set-local-rtc true</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="m2-key-m-接口">M.2 Key M 接口<a href="#m2-key-m-接口" class="hash-link" aria-label="Direct link to M.2 Key M 接口" title="Direct link to M.2 Key M 接口">​</a></h2>
<p>RUBIK Pi 3 提供一个标准 M.2 插槽，用于连接 NVMe 存储，可安装 2280 规格（22*80mm）M.2 SSD 硬盘。M.2 插槽最大支持 PCIe Gen 3 x 2。M.2 接口最大对外输出能力为 3.3V 2A，可单独控制开关。</p>
<p>M.2 Key M 接口使用了 QCS6490 的 PCIe1 总线，设备路径为：<em>/sys/bus/pci/devices/0001:00:00.0</em></p>
<p>M.2 Key M 接口为下图 18：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/image-148-ada577630c21124f573e06d6a81d5a9b.png" width="1477" height="615" class="img_ev3q"></p>
<p>M.2 Key M 接口可以接入规格为2280的固态硬盘，如下图所示：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/img_v3_02h3_2bbba98e-82ca-47ed-9b20-cf96deb8e13g-22466fa2863f0a65da2c53657761fd05.jpg" width="8192" height="6144" class="img_ev3q">
<img decoding="async" loading="lazy" src="/assets/images/img_v3_02h3_f64471dd-11fb-46bd-ae8a-72fdf86cc65g-f70432e724d8bd391ff6750516103453.jpg" width="8192" height="6144" class="img_ev3q"></p>
<p>接入显示器，开机后在桌面左侧会显示固态硬盘的图标</p>
<p><img decoding="async" loading="lazy" src="/assets/images/20250603-211430-2aa9ed666a9e9fb33243c450bf217b68.jpg" width="518" height="741" class="img_ev3q"></p>
<p>双击后显示固态硬盘中的内容
<img decoding="async" loading="lazy" src="/assets/images/20250603-211649-e9a8f75f7849a25b15f3dc90bf668e36.jpg" width="1528" height="856" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-功耗优化">PCIe 功耗优化<a href="#pcie-功耗优化" class="hash-link" aria-label="Direct link to PCIe 功耗优化" title="Direct link to PCIe 功耗优化">​</a></h3>
<p>PCIe 定义了两种功耗管理方法。</p>
<ul>
<li>
<p>功耗管理软件，用于确定每个设备的功耗管理功能并分别对各个设备进行管理</p>
</li>
<li>
<p>不需要软件干预的系统，例如主动状态功耗管理 (ASPM)</p>
</li>
</ul>
<p>当链路上未传输任何数据包时，设备会将链路置于节能状态。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-l0-链路状态">PCIe L0 链路状态<a href="#pcie-l0-链路状态" class="hash-link" aria-label="Direct link to PCIe L0 链路状态" title="Direct link to PCIe L0 链路状态">​</a></h4>
<p>PCIe 功耗管理定义下了 L0 链路状态：</p>
<ul>
<li>
<p>L0：工作状态</p>
</li>
<li>
<p>L0s：具有低恢复延迟的 ASPM 状态（节能待机状态）</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-设备状态">PCIe 设备状态<a href="#pcie-设备状态" class="hash-link" aria-label="Direct link to PCIe 设备状态" title="Direct link to PCIe 设备状态">​</a></h4>
<p>PCIe 功耗管理定义了以下设备状态：</p>
<ul>
<li>
<p>D0（必选）: 设备处于完全 ON 状态，此时存在两个子状态</p>
<ul>
<li>
<p>D0(uninitialized)：当设备退出复位状态后等待枚举和配置时，该功能处于 D0(uninitialized) 状态</p>
</li>
<li>
<p>D0(active)</p>
<ul>
<li>
<p>当完成枚举和配置过程后，该功能处于 D0(active) 状态</p>
</li>
<li>
<p>当系统软件启用一个或多个（任意组合）功能参数（如内存空间启用、I/O 空间启用、总线主启用（BME）位）时，该功能进入 D0(active) 状态</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>D1（可选）：轻度休眠状态</p>
<ul>
<li>
<p>该功能只能发出 PME 消息，无法发出其他 TLP</p>
</li>
<li>
<p>该功能只能充当配置事务的目标，无法充当其他事务的目标</p>
</li>
<li>
<p>该功能通过发出设定 PM 控制和状态寄存器的软件命令来进入 D1 状态</p>
</li>
</ul>
</li>
<li>
<p>D2（可选）：深度休眠状态</p>
<ul>
<li>
<p>该功能只能发出 PME 消息，无法发出其他 TLP</p>
</li>
<li>
<p>该功能只能充当配置事务的目标，无法充当其他事务的目标</p>
</li>
<li>
<p>该功能通过发出设定 PM 控制和状态寄存器的软件命令来进入 D2 状态</p>
</li>
</ul>
</li>
<li>
<p>D3（必选）：设备处于最低功耗状态，此时该功能必须支持两种 D3 状态</p>
</li>
<li>
<p>D3(hot)</p>
<ul>
<li>
<p>该功能只能发出 PME 消息，无法发出其他 TLP</p>
</li>
<li>
<p>该功能只能充当配置事务的目标，无法充当其他事务的目标</p>
</li>
<li>
<p>该功能通过设定功耗状态位域发出软件命令来进入 D3(hot) 状态</p>
</li>
</ul>
</li>
<li>
<p>D3(cold)：设备进入 D3(cold) 状态并断电；当恢复供电时，设备进入 D0(uninitialized) 状态</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcie-调试">PCIe 调试<a href="#pcie-调试" class="hash-link" aria-label="Direct link to PCIe 调试" title="Direct link to PCIe 调试">​</a></h3>
<p>M.2 Key M 接口使用了 QCS6490 的 PCIe1 总线，设备路径为：<em>/sys/bus/pci/devices/0001:00:00.0</em></p>
<p><code>lspci</code> 和 <code>setpci</code> 命令为 Linux 发行版的本机命令。这两条命令提供多种级别的输出，并且还可用于在某个时间点查看 PCI 总线上训练的不同组件的功能和状态。这些功能大多反映的是 PCIe 基本规范所需的配置空间寄存器。更多详细信息，可访问 <a href="https://pcisig.com/specifications" target="_blank" rel="noopener noreferrer">https://pcisig.com/specifications</a>
如需查看使用说明，可运行以下命令。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lspci --help</span><br></span></code></pre></div></div>
<p>以下功能有助于解决 PCIe 问题。</p>
<ul>
<li>
<p>显示设备信息</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lspci</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0000:00:00.0 PCI bridge: Qualcomm Device 010b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000:01:00.0 USB controller: Renesas Technology Corp. uPD720201 USB 3.0 Host Controller (rev 03)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0001:00:00.0 PCI bridge: Qualcomm Device 010b</span><br></span></code></pre></div></div>
</li>
<li>
<p>显示设备控制寄存器中的 PCIe 设备和厂商 ID。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lspci -nvmm</span><br></span></code></pre></div></div>
<p>示例输出</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Slot:        00:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class:        0604</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor:        17cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device:        010b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IOMMUGroup:        6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slot:        01:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class:        0c03</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor:        1912</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device:        0014</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rev:        03</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProgIf:        30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IOMMUGroup:        6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slot:        0001:00:00.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Class:        0604</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vendor:        17cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device:        010b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DTNode:        /sys/firmware/devicetree/base/soc@0/pci@1c08000/pcie@1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IOMMUGroup:        7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/hongyang-rp/rubikpi-ubuntu-user-manual-test.github.io/tree/main/docs/Document Home/2.peripherals-and-interfaces-cn.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Document Home/get-started-cn"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">快速开始</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Document Home/github-peration-guide-cn"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">GitHhub 操作指南</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#硬件资源图" class="table-of-contents__link toc-highlight">硬件资源图</a></li><li><a href="#40-pin-连接器" class="table-of-contents__link toc-highlight">40 pin 连接器</a><ul><li><a href="#gpio" class="table-of-contents__link toc-highlight">GPIO</a><ul><li><a href="#引脚分布" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-shell-命令控制" class="table-of-contents__link toc-highlight">使用 shell 命令控制</a></li><li><a href="#使用-wiringrp-c-控制" class="table-of-contents__link toc-highlight">使用 WiringRP (C) 控制</a></li><li><a href="#使用-wiringrp-python-控制" class="table-of-contents__link toc-highlight">使用 WiringRP-Python 控制</a></li><li><a href="#使用-python-程序控制" class="table-of-contents__link toc-highlight">使用 Python 程序控制</a></li><li><a href="#使用-c-语言程序控制" class="table-of-contents__link toc-highlight">使用 C 语言程序控制</a></li></ul></li><li><a href="#i2c" class="table-of-contents__link toc-highlight">I2C</a><ul><li><a href="#引脚分布-1" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-shell-命令测试" class="table-of-contents__link toc-highlight">使用 shell 命令测试</a></li><li><a href="#使用-wiringrp-c-i2c-通信" class="table-of-contents__link toc-highlight">使用 WiringRP (C) I2C 通信</a></li><li><a href="#使用-wiringrp-python-i2c-通信" class="table-of-contents__link toc-highlight">使用 WiringRP-Python I2C 通信</a></li><li><a href="#使用-python-程序-i2c-通信" class="table-of-contents__link toc-highlight">使用 Python 程序 I2C 通信</a></li><li><a href="#使用-c-语言程序-i2c-通信" class="table-of-contents__link toc-highlight">使用 C 语言程序 I2C 通信</a></li></ul></li><li><a href="#spi" class="table-of-contents__link toc-highlight">SPI</a><ul><li><a href="#引脚分布-2" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-wiringrp-c-spi-通信" class="table-of-contents__link toc-highlight">使用 WiringRP (C) SPI 通信</a></li><li><a href="#使用-wiringrp-python-spi通信" class="table-of-contents__link toc-highlight">使用 WiringRP-Python SPI通信</a></li><li><a href="#使用-python-程序-spi-通信" class="table-of-contents__link toc-highlight">使用 Python 程序 SPI 通信</a></li><li><a href="#使用-c-语言程序-spi-通信" class="table-of-contents__link toc-highlight">使用 C 语言程序 SPI 通信</a></li></ul></li><li><a href="#uart" class="table-of-contents__link toc-highlight">UART</a><ul><li><a href="#引脚分布-3" class="table-of-contents__link toc-highlight">引脚分布</a></li><li><a href="#使用-shell-命令测试-1" class="table-of-contents__link toc-highlight">使用 shell 命令测试</a></li><li><a href="#使用-wiringrp-c-uart通信" class="table-of-contents__link toc-highlight">使用 WiringRP (C) UART通信</a></li><li><a href="#使用-wiringrp-python-uart-通信" class="table-of-contents__link toc-highlight">使用 WiringRP-Python UART 通信</a></li><li><a href="#使用-python-程序-uart-通信" class="table-of-contents__link toc-highlight">使用 Python 程序 UART 通信</a></li><li><a href="#使用-c-语言程序-uart-通信" class="table-of-contents__link toc-highlight">使用 C 语言程序 UART 通信</a></li></ul></li></ul></li><li><a href="#usb" class="table-of-contents__link toc-highlight">USB</a><ul><li><a href="#usb-20-type-a-接口" class="table-of-contents__link toc-highlight">USB 2.0 Type-A 接口</a></li><li><a href="#usb-31-type-c-接口" class="table-of-contents__link toc-highlight">USB 3.1 Type-C 接口</a></li><li><a href="#usb-调试" class="table-of-contents__link toc-highlight">USB 调试</a><ul><li><a href="#usb-跟踪" class="table-of-contents__link toc-highlight">USB 跟踪</a></li><li><a href="#usb-寄存器打印" class="table-of-contents__link toc-highlight">USB 寄存器打印</a></li><li><a href="#主机-sysfs-查询" class="table-of-contents__link toc-highlight">主机 sysfs 查询</a></li></ul></li></ul></li><li><a href="#相机串行接口csi" class="table-of-contents__link toc-highlight">相机串行接口（CSI）</a><ul><li><a href="#摄像头排线安装" class="table-of-contents__link toc-highlight">摄像头排线安装</a></li><li><a href="#摄像头使用方法" class="table-of-contents__link toc-highlight">摄像头使用方法</a></li><li><a href="#摄像头故障排除" class="table-of-contents__link toc-highlight">摄像头故障排除</a></li></ul></li><li><a href="#hdmi-out" class="table-of-contents__link toc-highlight">HDMI OUT</a><ul><li><a href="#cec" class="table-of-contents__link toc-highlight">CEC</a></li><li><a href="#hdmi-out-触摸屏" class="table-of-contents__link toc-highlight">HDMI OUT 触摸屏</a></li><li><a href="#hdmi-out-调试" class="table-of-contents__link toc-highlight">HDMI OUT 调试</a><ul><li><a href="#获取-lt9611-日志" class="table-of-contents__link toc-highlight">获取 lt9611 日志</a></li><li><a href="#获取-dsi-日志" class="table-of-contents__link toc-highlight">获取 DSI 日志</a></li><li><a href="#获取调压器信息" class="table-of-contents__link toc-highlight">获取调压器信息</a></li><li><a href="#获取接口信息" class="table-of-contents__link toc-highlight">获取接口信息</a></li><li><a href="#获取常规-dpu-调试信息" class="table-of-contents__link toc-highlight">获取常规 DPU 调试信息</a></li></ul></li></ul></li><li><a href="#displayport" class="table-of-contents__link toc-highlight">DisplayPort</a><ul><li><a href="#wi-fi" class="table-of-contents__link toc-highlight">Wi-Fi</a><ul><li><a href="#工作频段" class="table-of-contents__link toc-highlight">工作频段</a></li><li><a href="#工作模式" class="table-of-contents__link toc-highlight">工作模式</a></li></ul></li><li><a href="#蓝牙" class="table-of-contents__link toc-highlight">蓝牙</a></li></ul></li><li><a href="#音频" class="table-of-contents__link toc-highlight">音频</a></li><li><a href="#风扇" class="table-of-contents__link toc-highlight">风扇</a><ul><li><a href="#风扇安装" class="table-of-contents__link toc-highlight">风扇安装</a></li><li><a href="#风扇控制方法" class="table-of-contents__link toc-highlight">风扇控制方法</a></li></ul></li><li><a href="#led" class="table-of-contents__link toc-highlight">LED</a></li><li><a href="#以太网" class="table-of-contents__link toc-highlight">以太网</a><ul><li><a href="#调试以太网" class="table-of-contents__link toc-highlight">调试以太网</a></li></ul></li><li><a href="#rtc-电池接口" class="table-of-contents__link toc-highlight">RTC 电池接口</a></li><li><a href="#m2-key-m-接口" class="table-of-contents__link toc-highlight">M.2 Key M 接口</a><ul><li><a href="#pcie-功耗优化" class="table-of-contents__link toc-highlight">PCIe 功耗优化</a><ul><li><a href="#pcie-l0-链路状态" class="table-of-contents__link toc-highlight">PCIe L0 链路状态</a></li><li><a href="#pcie-设备状态" class="table-of-contents__link toc-highlight">PCIe 设备状态</a></li></ul></li><li><a href="#pcie-调试" class="table-of-contents__link toc-highlight">PCIe 调试</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>